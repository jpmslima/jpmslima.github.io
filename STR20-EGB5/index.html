<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="jpmslima" /><link rel="canonical" href="https://jpmslima.github.io/STR20-EGB5/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Dinâmica Molecular - Tutoriais BioinfoX</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Din\u00e2mica Molecular";
        var mkdocs_page_input_path = "STR20-EGB5.md";
        var mkdocs_page_url = "/STR20-EGB5/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Tutoriais BioinfoX
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Página Inicial</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../aboutus/">Sobre o grupo</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutoriais Iniciais de Bioinformática</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basic1/">Inicial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../101/">Introdução a linha de comando UNIX</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../102/">Manipulando dados na CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../103/">Introdução ao GenBank</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../104/">Buscas de Similaridade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../105/">Alinhamento entre pares de sequências</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../106-MSA/">Alinhamento Múltiplo de Sequências</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../107-NCBI-CLI/">NCBI/GenBank via CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../108-BLAST-CLI/">BLAST via CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../109-SQL/">Comandos Básicos em SQL</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../enzima-annot/">Integração de Bancos - Exemplo</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../KEGG/">Explorando Vias Metabólicas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../110-BDs/">Bancos de Dados de Informação Proteica</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../111-Modelagem/">Modelagem Computacional de Proteínas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../112-MEGAX/">Primeiros Passos no MEGA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../113-Genomes/">Navegando por Genomas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../video/">Videoaulas</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Bioinformática Estrutural</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../basic2/">Inicial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../slides/">Slides de Acompanhamento</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tools/">Programas e Ferramentas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR1-Visualizacao/">Visualização Computacional de Moléculas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR2-pred/">Informações a partir da estrutura primária</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR22-Epitopos/">Predição de Epítopos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR3-Model1/">Modelagem 101</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR4-Model2/">Modelagem 102</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR5-Model3/">Modeller-CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR6-AlphaFold/">Métodos baseados em IA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR7-MDA/">MDA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR8-Aval/">Avaliação dos Modelos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR9-EM/">EM/CryoEM fitting</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR10-RINs/">RINs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR11-APBS/">APBS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR12-Memb/">Proteínas de Membrana</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR13-Dock1/">Autodock (básico)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR14-Dock2/">Docking</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR15-VS1/">Virtual Screening</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR23-MDIntro/">Introdução a Dinâmica Molecular</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR16-EGB1/">Modelos de Pequenas Moléculas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR17-EGB2/">Análise conformacional</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR18-EGB3/">Docking Automático</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR19-EGB4/">Posicionamento Manual</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Dinâmica Molecular</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#primeiros-passos">Primeiros Passos</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#analisando-as-interacoes-ligantes-de-proteina-e-dinamica-de-ligantes">Analisando as Interações Ligantes de Proteína e Dinâmica de Ligantes</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR21-EGB6/">VS-2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../comps/">Complements</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Diplomado - UChile</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../Presentation/">Home</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../UC_slides/">Slides</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Material/">Files and References</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../First_Tutorial_ENG/">First Tutorial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Substitution_saturation_ENG/">Analysis of Substitution Saturation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ModelTest_ENG/">Test of the Best-Fit Models</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MEGAX_ENG/">Using MEGAX</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../1st_BEAST/">Using BEAST</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../BEAST%2BEBSP_ENG/">Phylodynamics using EBSP</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../IQTree/">Using IQ-Tree</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Tutoriais BioinfoX</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Bioinformática Estrutural</li>
      <li class="breadcrumb-item active">Dinâmica Molecular</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="otimizacao-da-ligacao-ligante-receptor-com-dinamica-molecular">Otimização da ligação ligante receptor com dinâmica molecular</h1>
<p>Prof. Euzébio Guimarães – DFAR – BioME - UFRN</p>
<p>Esse tutorial é baseado neste: <a href="http://www.mdtutorials.com/gmx/complex/index.html">http://www.mdtutorials.com/gmx/complex/index.html</a></p>
<h2 id="primeiros-passos">Primeiros Passos</h2>
<p>Este exemplo guiará um novo usuário através do processo de configuração de um sistema de simulação contendo uma proteína em complexo com um ligante. Este tutorial se concentra especificamente em questões relacionadas ao lidar com o ligante, supondo que o usuário esteja familiarizado com as operações básicas do GROMACS e o conteúdo de uma topologia. Se este não for o caso, por favor, consulte um tutorial mais básico antes de tentar este. Este tutorial requer uma versão do GROMACS na série 2018.1 já instalada se você o tutorial de instalação passado durante o curso.</p>
<p>Temos que baixar o arquivo de estrutura da proteína com o qual estaremos trabalhando. Para este tutorial, utilizaremos a lisozima L99A / M102Q de T4 (código PDB <a href="http://www.rcsb.org/structure/3HTB">3HTB</a>). Vá para o site da RCSB e baixe o arquivo PDB para essa estrutura. Temos que isolar as estruturas do ligante em um arquivo <code>recep.pdb</code> e do ligante num arquivo <code>lig_free.pdb</code>. Temos que remover também o <strong>PO4</strong> e <strong>BME</strong>.</p>
<p>Importante que a estrutura do receptor esteja sempre sem erros. Quais erros?</p>
<ol>
<li>Remover artefatos da cristalografia (PO4 e BME, neste caso).</li>
<li>Completar tudo que falta na proteína (Pelo menos <em>loops</em> faltantes).</li>
<li>Modificações pós-traducionais que podem provocar problemas a sua análise. (Procure outros tutoriais).</li>
</ol>
<p>Utilize também a ferramenta DockPrep para remover defeitos automaticamente.</p>
<p><img alt="DockPrep" src="../str20-fig1.png" /></p>
<p>Apague o ligante após salva-lo. Agora salve o receptor com <code>recep.pdb</code> e converta para os arquivos necessários para o <strong>Gromacs</strong>, com o seguinte comando:</p>
<pre><code class="language-shell">gmx pdb2gmx -f recep.pdb -ignh
</code></pre>
<blockquote>
<p><em>Verifique a saída do comando acima. A carga da proteína estará especificada.</em></p>
</blockquote>
<p>Quando perguntado, você vai ter que escolher o campo de força.</p>
<ul>
<li>
<p>Vamos escolher a opção 14: <strong>GROMOS96 54a7 force field</strong> (<a href="https://www.ncbi.nlm.nih.gov/pubmed/21533652">Schmid et al. Eur. Biophys. J. (2011), 40, 843-856</a>.  </p>
</li>
<li>
<p>Em: <strong>Select the Water Model</strong>, escolha 1: <strong>SPC simple point charge, recommended</strong>.</p>
</li>
</ul>
<p>Serão criados vários arquivos: <code>posre.itp</code> (Restrições de Posições) <code>conf.gro</code> (Coordenadas da proteína) e <code>topol.top</code> (Topologia do campo de força).</p>
<p>A topologia do ligante será criada no servidor <a href="https://atb.uq.edu.au/">Automated Topology Builder (ATB) and Repository</a>. A qualidade da topologia é muito alta. Basta submeter aos cálculos. Demora cerca de um dia. Se você quiser utilizar um método diferente basta verificar o <a href="https://www.youtube.com/watch?v=PCn5jMiJP3M&amp;list=PLRLpdK3kOpA-6cijGtyNnFFesPcPj0P2o">meu Canal no YouTube</a></p>
<p>Esse arquivo já existe: <a href="https://atb.uq.edu.au/molecule.py?molid=268633#panel-md">https://atb.uq.edu.au/molecule.py?molid=268633#panel-md</a></p>
<p><img alt="Gromacs Files" src="../str20-fig2.png" /></p>
<p>Edite estes arquivos trocando o nome dos átomos do que aparecer para <strong>LIG</strong>.</p>
<p><strong>Importante</strong>
Verifique se na página do ATB possui uma mensagem como a abaixo:</p>
<p><img alt="ATB Message" src="../str20-fig9.png" /></p>
<p>Caso possua tal aviso para o campo de força que irás utilizar, você precisa baixar esses arquivos para a versão do Gromacs da sua máquina. Descompacte o arquivo e coloque a pasta original dentro da pasta do Gromacs, usualmente <code>/usr/share/gromacs/top/</code>. Depois você terá de modificar seu arquivo de topologia (veremos isso mais adiante).</p>
<p>Confira se o <code>lig.pdb</code> está posicionado no sítio receptor assim como o ligante cristalografado. Neste caso não está, então faça um <em>docking</em> manual, pois o que interessa é apenas a conformação inicial e não a avaliação pela função de escore.</p>
<p><img alt="Chimera" src="../str20-fig3.png" /></p>
<p>Após mudar a posição salve com <code>lig2.pdb</code> novamente e não se esqueça de escolher a opção <code>Save relative to model</code>: Escolha o <code>recep.pdb</code>. Feito isso basta converter para o formato <code>.gro</code> com o comando:</p>
<pre><code class="language-shell">gmx editconf -f lig2.pdb -o lig2.gro
</code></pre>
<p>Agora vamos combinar os dois arquivos <code>conf.gro</code> e <code>lig2.gro</code>. Mova os <em>atoms</em> (apenas os átomos) do <code>lig2.gro</code> para o <code>recep.gro</code>. Mude a segunda linha do arquivo <code>recep.gro</code> para o número de atomos total formado pela junção dos dos arquivos. Feito isso confira se o <code>conf.gro</code> agora tem o ligante.</p>
<pre><code class="language-shell">chimera conf.gro
</code></pre>
<p>Agora edite o arquivo <code>topol.top</code> adicionado o seguinte trecho e salve o <code>topol.top</code>:</p>
<pre><code class="language-text">; Include forcefield parameters
#include &quot;gromos54a7.ff/forcefield.itp&quot;
#include &quot;lig.itp&quot;
</code></pre>
<p>No final do arquivo.</p>
<pre><code class="language-text">[ molecules ]
; Compound        #mols
Protein_chain_A     1
LIG                         1
</code></pre>
<blockquote>
<p><em>Algumas linhas acima estão repetidas, basta adicionar o que está diferente.</em></p>
</blockquote>
<p>Neste ponto, o fluxo de trabalho vamos definir a célula unitária e preenchê-la com água:</p>
<pre><code class="language-shell">gmx editconf -f conf.gro -o box.gro -bt triclinic -d 1.0 -princ
</code></pre>
<p>Escolha <strong>1 - Protein</strong>:</p>
<pre><code class="language-shell">gmx solvate -cp box.gro -cs spc216.gro -p topol.top -o box_sol.gro
</code></pre>
<p>Vamos usar o programa VMD para vizualizar a caixa <code>box_sol.gro</code>:</p>
<pre><code class="language-shell">vmd box_sol.gro
</code></pre>
<p><img alt="VMD 1" src="../str20-fig4.png" /></p>
<p>Agora temos um sistema solvatado. A saída do comando <code>pdb2gmx</code> nos disse que a proteína tem uma carga líquida de +6 (com base na composição de aminoácidos). Se você perdeu esta informação na saída pdb2gmx. Desta forma, devemos acrescentar íons ao nosso sistema.</p>
<p>Use grompp para criar um arquivo <code>.tpr</code>, usando qualquer arquivo <code>.mdp</code>. Baixe o arquivo necessário <a href="https://drive.google.com/uc?export=download&amp;id=1xbKUJ_CTKvM9Ry3iMQolytnbJ7cBErug">AQUI</a></p>
<pre><code class="language-shell">gmx grompp -f ions.mdp -c box_sol.gro -p topol.top -o ions.tpr
</code></pre>
<p>Vai resultar no seguinte erro:</p>
<pre><code class="language-shell">ERROR 1 [file lig.itp, line 78]:
  Atomtype HS14 not found
</code></pre>
<p>Basta editar o arquivo <code>lig.itp</code> e trocar os termos HS14 por H simplesmente. Rode novamente.</p>
<pre><code class="language-shell">gmx grompp -f ions.mdp -c box_sol.gro -p topol.top -o ions.tpr
</code></pre>
<p>Observe que o sistema não tem carga zero:</p>
<pre><code class="language-shell">NOTE 2 [file topol.top, line 11009]:
  System has non-zero total charge: 6.000000
  Total charge should normally be an integer. See
</code></pre>
<pre><code class="language-shell">gmx genion -s ions.tpr -o box_sol_ion.gro -p topol.top -pname NA -nname CL -neutral
</code></pre>
<p>Selecione a opção <code>[SOL]</code> para remover moléculas de água e trocar pelos ions.</p>
<p>Veja o arquivo <code>topol.top</code> no sua diretiva <code>[molecules]</code> agora deve se parecer algo assim:</p>
<pre><code class="language-text">[ molecules ]
; Compound        #mols
Protein_chain_A     1
LIG                 1
SOL         6885
CL               6
</code></pre>
<p>Agora que o sistema está montado, crie a entrada binária usando o grompp usando este arquivo de parâmetro de entrada. Mas antes baixe <a href="https://drive.google.com/uc?export=download&amp;id=1goHOyLDcKRttBanH8DixBiIH7Xoc9MH0">esse arquivo</a> para seu diretório de simulação.</p>
<pre><code class="language-shell">gmx grompp -f em.mdp -c box_sol_ion.gro -p topol.top -o EM.tpr
</code></pre>
<p>Certifique-se de ter atualizado seu arquivo <code>topol.top</code> ao rodar o genbox e o genion, senão você receberá muitas mensagens de erro desagradáveis (<em>“number of coordinates in coordinate file does not match topology”</em>, etc.).</p>
<p>Agora estamos prontos para rodar o <code>mdrun</code> para realizar uma minimização de energia:</p>
<pre><code class="language-shell">gmx mdrun -v -deffnm EM
</code></pre>
<p>Serão criados diversos arquivos com o nome base <code>EM</code>, por exemplo: <code>EM.trr</code> (trajetória, <em>frames</em> da simulação, pode ser <code>EM.xtc</code>), <code>EM.log</code> (log), <code>EM.edr</code> (Arquivos de energia) e <code>EM.gro</code> (O arquivo de coordenadas final com a coformação do complexo otimizado.</p>
<p>Para visualizar o que aconteceu na otimização basta dar o comando para o UCSF Chimera:</p>
<pre><code class="language-shell">chimera EM.gro
</code></pre>
<p>Próxima etapa será a equilibração dos parâmetros termodinâmicos do sistema. Equilibrar nosso complexo de proteína-ligante será como equilibrar qualquer outro sistema que contenha uma proteína em água. Existem algumas considerações especiais, neste caso aplicar restrições ao ligante.</p>
<p>Para restringir o ligante, precisaremos gerar uma topologia de restrição de posição para isso. Primeiro, crie um grupo de índice para LIG que contenha apenas seus átomos não-hidrogênio:</p>
<pre><code class="language-shell">gmx make_ndx -f lig2.gro -o index_lig.ndx
</code></pre>
<p>Digite:</p>
<pre><code class="language-shell"> &gt; 0 &amp; ! a H*
 &gt; q
</code></pre>
<p>Em seguida, execute o módulo genrestr e selecione esse grupo de índices recém-criado (que será o grupo 3 no arquivo <code>index_lig.ndx</code>):</p>
<pre><code class="language-shell">gmx genrestr -f lig2.gro -n index_lig.ndx -o posre_lig.itp -fc 1000 1000 1000
</code></pre>
<p>Selecione o grupo 3 (<code>'System_&amp;_!H*'</code>)</p>
<p>Agora, precisamos incluir essas informações no <code>topol.top</code>. Podemos fazer isso de várias maneiras, dependendo das condições que desejamos usar. Se simplesmente quisermos restringir o ligante sempre que a proteína também estiver restrita, adicione as seguintes linhas ao <code>lig.itp</code> no final do arquivo:</p>
<pre><code class="language-text">; Include Position restraint file
#ifdef POSRES
#include &quot;posre_lig.itp&quot;
#endif
</code></pre>
<p>Agora baixe <a href="https://drive.google.com/uc?export=download&amp;id=1WpiRPxSp0jxZkPUIw8wNocYxS-plrbC5">AQUI</a> o arquivo de equilibração que contém o conjunto conânico nVT, onde número de partículas, volume e temperatura serão mantidos constantes (<code>nvt.mdp</code>).</p>
<p>Agora execute:</p>
<pre><code class="language-shell">gmx grompp -f nvt.mdp -c EM.gro -r EM.gro -p topol.top -o NVT.tpr
gmx mdrun -v -deffnm NVT
</code></pre>
<p>Vamos verificar se a energia potencial do sistema estabiliza utilizando o programa GRACE:</p>
<pre><code class="language-shell">gmx energy -f NVT.edr
</code></pre>
<p>Selecione a opção Pontetial dê ENTER duas vezes. Agora plote o resultado com xmgrace:</p>
<pre><code class="language-shell">xmgrance -nxy energy.xvg
</code></pre>
<p><img alt="Gromacs-GRACE" src="../str20-fig5.png" /></p>
<p>Observe que a energia potencia se estabiliza muito bem logo após o inicio da simulação.</p>
<p>Vamos agora vizualizar a simulação com o programa VMD:</p>
<pre><code class="language-shell">vmd EM.gro NVT.xtc
</code></pre>
<p>Vá no menu *<em>Graphics &gt; Representations…</em></p>
<p>Em <code>Selected atoms</code> escreva <strong><em>protein</em></strong>, depois Clique em <code>Create Rep</code> e digite <strong><em>resname LIG</em></strong>. Mude o <code>Drawing Method</code> para cada seleção como mostrado na figura.</p>
<p><img alt="VMD-1" src="../str20-fig6.png" /></p>
<p>Na outra janela clique em <em>Play</em>:</p>
<p><img alt="VMD-2" src="../str20-fig7.png" /></p>
<p>Na próxima etapa varemos a equilibração da pressão do sistema variando o volume da caixa. Quando a simulação do NVT estiver concluída, prossiga para o NPT com este arquivo <a href="https://drive.google.com/uc?export=download&amp;id=1P9DWiMpxyAVmtwX-wT9tjiT35qn9zSGx">npt.mdp</a>.</p>
<pre><code class="language-shell">gmx grompp -f npt.mdp -c NVT.gro -t NVT.cpt -r NVT.gro -p topol.top -o NPT.tpr
gmx mdrun -deffnm NPT
</code></pre>
<p>Após a conclusão das duas fases de equilibração, o sistema está agora bem equilibrado à temperatura e pressão desejadas. Agora estamos prontos para liberar as restrições de posição e executar o MD de produção para coleta de dados. O processo é exatamente como vimos anteriormente, pois usaremos o arquivo de ponto de verificação para fazer o grompp. Vamos executar uma simulação MD de 10 ns, cujo script pode ser encontrado <a href="https://drive.google.com/uc?export=download&amp;id=1ilgeSnjglY1tkWE3MHr7NuOcED2_DXOK">AQUI</a>.</p>
<pre><code class="language-shell">gmx grompp -f md.mdp -c NPT.gro -t NPT.cpt -p topol.top -o MD.tpr
gmx mdrun -v -deffnm MD
</code></pre>
<p>Esta simulação poderá demorar 24 horas. Aguarde.</p>
<blockquote>
<p><em>Vamos rodar 50000 passos para esse tutorial, mas não faça isso. Rode o tempo todo recomendado.</em></p>
</blockquote>
<p>Para corrigir a movimentação da proteína dentro da caixa:</p>
<pre><code class="language-shell">gmx trjconv -s MD.tpr -f MD.xtc -o MD_center.xtc -center -pbc mol -ur compact
</code></pre>
<p>Escolha <em>“Protein”</em> para centralizar e <em>“System”</em> para saída. Observe que os complexos de centralização (proteína-ligante, proteína-proteína) podem ser difíceis para simulações mais longas, envolvendo muitos saltos através dos limites periódicos. Nesses casos (particularmente em complexos proteína-proteína), pode ser necessário criar um grupo de índices personalizado para usar para centrar, correspondendo ao sítio ativo de uma proteína ou aos resíduos interfaciais de um monômero em um complexo.</p>
<p>Opcionalmente execute o comando abaixo para tornar ainda mais sua a visualização dos resultados.</p>
<pre><code class="language-shell">gmx trjconv -s MD.tpr -f MD_center.xtc -o MD_fit.xtc -fit rot+trans
</code></pre>
<p>Escolha <em>“Backbone”</em> para realizar ajustes de mínimos quadrados no <em>backbone</em> da proteína e <em>“System”</em> para saída.</p>
<p>Você pode usar o próprio UCSF Chimera para visualizar os resultados também. Utilize a ferramenta <code>MD Movie</code>. Selecione gromacs. Abra o <code>MD.tpr</code> e o <code>MD_center.xtc</code>.</p>
<h2 id="analisando-as-interacoes-ligantes-de-proteina-e-dinamica-de-ligantes">Analisando as Interações Ligantes de Proteína e Dinâmica de Ligantes</h2>
<p>Este tutorial não pode cobrir todos os métodos de análise que você deseja realizar. Algumas operações básicas serão ilustradas aqui.</p>
<p>O módulo GROMACS hbond pode ser facilmente empregado para calcular o número de ligações de hidrogênio entre qualquer grupo de átomos, mas no nosso caso, os únicos valores serão 1 ou 0. Para uma visão mais detalhada de como o ligante está interagindo com Gln102, calcule a distância entre o grupo hidroxila do LIG e a carbonila da Gln102. Para que uma ligação de hidrogênio seja formada, o critério típico é que os átomos doadores e aceitadores serão separados por uma distância ≤3,5 Å (0,35 nm). Use o módulo de distância para calcular a distância ao longo da trajetória, usando a sintaxe de seleção da linha de comando (consulte seleções de ajuda do gmx para exemplos e mais sintaxe).</p>
<p><img alt="Distâncias" src="../str20-fig8.png" /></p>
<pre><code class="language-shell">gmx distance -s MD.tpr -f MD_center.xtc -select 'resname &quot;LIG&quot; and name H12 plus resid 102 and name OE1' -oall
</code></pre>
<p>A distância média foi 0.19±0.028 do Hidrogênio da hidroxila do ligante até o carbono da carbonila do resíduo Gln102.</p>
<p>Podemos também estimar a energia de interação entre o ligante e a vizinhança para ter noção sobre a afinidade de ligação. No arquivo <code>.mdp</code> da simulação foram criadas as energias de interação entre o ligante e a vizinhança, Proteína, Solvente e Íons. Para isso executamos o seguinte comando:</p>
<pre><code class="language-shell">gmx energy -f MD.edr
</code></pre>
<p>Vamos selecionar as opções relacionadas às interações de curta distância do ligante.</p>
<pre><code class="language-shell">Energy                      Average   Err.Est.       RMSD  Tot-Drift
-------------------------------------------------------------------------------
Coul-SR:Protein-LIG        -35.8895        2.4    9.45151    2.71042  (kJ/mol)
LJ-SR:Protein-LIG           -71.099        2.5    7.08961    8.78349  (kJ/mol)
Coul-SR:LIG-SOL            -21.7505        3.4    11.7535   -15.2064  (kJ/mol)
LJ-SR:LIG-SOL              -2.73363        2.2    6.52593    5.11542  (kJ/mol)
Coul-SR:LIG-CL                    0          0          0          0  (kJ/mol)
LJ-SR:LIG-CL                      0          0          0          0  (kJ/mol)
</code></pre>
<p>Pela soma das energias temos: -131.46±5.33 kJ/mol ou -31.40±1.27 kcal/mol.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../STR19-EGB4/" class="btn btn-neutral float-left" title="Posicionamento Manual"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../STR21-EGB6/" class="btn btn-neutral float-right" title="VS-2">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../STR19-EGB4/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../STR21-EGB6/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
