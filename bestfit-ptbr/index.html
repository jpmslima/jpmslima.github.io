<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="jpmslima" /><link rel="canonical" href="https://jpmslima.github.io/bestfit-ptbr/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Escolha do Modelo de Substitui√ß√£o - Tutoriais BioinfoX</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Escolha do Modelo de Substitui\u00e7\u00e3o";
        var mkdocs_page_input_path = "bestfit-ptbr.md";
        var mkdocs_page_url = "/bestfit-ptbr/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Tutoriais BioinfoX
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">P√°gina Inicial</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../demo/">Representa√ß√£o Computacional de Biomol√©culas</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../aboutus/">Sobre o grupo</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutoriais Iniciais de Bioinform√°tica</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basic1/">Inicial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../101/">Introdu√ß√£o a linha de comando UNIX</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../102/">Manipulando dados na CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CLI-Colab/">Introdu√ß√£o a CLI e ao Google Colab</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../103/">Introdu√ß√£o ao GenBank</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../104/">Buscas de Similaridade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../105/">Alinhamento entre pares de sequ√™ncias</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../106-MSA/">Alinhamento M√∫ltiplo de Sequ√™ncias</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../107-NCBI-CLI/">NCBI/GenBank via CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../108-BLAST-CLI/">BLAST via CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../109-SQL/">Comandos B√°sicos em SQL</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../r-colab/">Introdu√ß√£o ao R usando o Google Colab</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../enzima-annot/">Integra√ß√£o de Bancos - Exemplo</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../KEGG/">Explorando Vias Metab√≥licas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../110-BDs/">Bancos de Dados de Informa√ß√£o Proteica</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../111-Modelagem/">Modelagem Computacional de Prote√≠nas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../112-MEGAX/">Primeiros Passos no MEGA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../113-Genomes/">Navegando por Genomas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../video/">Videoaulas</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Bioinform√°tica Estrutural</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basic2/">Inicial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../slides/">Slides de Acompanhamento</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tools/">Programas e Ferramentas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR1-Visualizacao/">Visualiza√ß√£o Computacional de Mol√©culas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR2-pred/">Informa√ß√µes a partir da estrutura prim√°ria</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR22-Epitopos/">Predi√ß√£o de Ep√≠topos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR3-Model1/">Modelagem 101</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR4-Model2/">Modelagem 102</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../STR5-Model3.mkdocs gh-deploy --forcemd">Modeller-CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR6-AlphaFold/">M√©todos baseados em IA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR7-MDA/">MDA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR8-Aval/">Avalia√ß√£o dos Modelos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR9-EM/">EM/CryoEM fitting</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR10-RINs/">RINs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR11-APBS/">APBS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR12-Memb/">Prote√≠nas de Membrana</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR13-Dock1/">Autodock (b√°sico)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR14-Dock2/">Docking</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR15-VS1/">Virtual Screening</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR23-MDIntro/">Introdu√ß√£o a Din√¢mica Molecular</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR16-EGB1/">Modelos de Pequenas Mol√©culas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR17-EGB2/">An√°lise conformacional</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR18-EGB3/">Docking Autom√°tico</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR19-EGB4/">Posicionamento Manual</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR20-EGB5/">Din√¢mica Molecular</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR21-EGB6/">VS-2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../comps/">Complements</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">An√°lise Evolucion√°ria de Sequ√™ncias (Evolu√ß√£o Molecular)</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../satsub-ptbr/">An√°lise de Satura√ß√£o de Substitui√ß√µes</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Escolha do Modelo de Substitui√ß√£o</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#introducao">Introdu√ß√£o</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#usando-o-mega-x">Usando o MEGA X</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#usando-o-jmodeltest">Usando o jModelTest</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#etapas">Etapas:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#usando-o-prottest">Usando o ProtTest</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#comparacao-de-resultados">Compara√ß√£o de resultados</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#usando-o-modeltest-ng">Usando o ModelTest-NG</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#etapas_1">Etapas:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#consideracoes-finais">Considera√ß√µes Finais</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#que-criterios-devo-usar-para-escolher-o-modelo-de-substituicao">Que crit√©rios devo usar para escolher o modelo de substitui√ß√£o?</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#o-modelo-escolhido-nao-existe-na-ferramenta-que-usarei">O modelo escolhido n√£o existe na ferramenta que usarei</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#filogenia-media-de-todos-os-modelos">Filogenia m√©dia de todos os modelos</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../BEAST_ptbr/">Usando o BEAST</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Diplomado - UChile</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../Presentation/">Home</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../UC_slides/">Slides</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Material/">Files and References</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../First_Tutorial_ENG/">First Tutorial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Substitution_saturation_ENG/">Analysis of Substitution Saturation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ModelTest_ENG/">Test of the Best-Fit Models</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MEGAX_ENG/">Using MEGAX</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../1st_BEAST/">Using BEAST</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../BEAST%2BEBSP_ENG/">Phylodynamics using EBSP</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../IQTree/">Using IQ-Tree</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Tutoriais BioinfoX</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">An√°lise Evolucion√°ria de Sequ√™ncias (Evolu√ß√£o Molecular)</li>
      <li class="breadcrumb-item active">Escolha do Modelo de Substitui√ß√£o</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="escolhendo-um-modelo-de-substituicao-apropriado">Escolhendo um Modelo de Substitui√ß√£o Apropriado</h1>
<h2 id="introducao">Introdu√ß√£o</h2>
<p>O objetivo deste tutorial √© mostrar as diferentes formas de avaliar e estimar um modelo de substitui√ß√£o de nucleot√≠deos (e amino√°cidos) adequado para seu <em>conjunto de dados</em>, com o intuito de realizar uma an√°lise filogen√©tica posterior.</p>
<p>Como destacado durante a aula, a etapa de estimar um modelo de substitui√ß√£o <strong>n√£o √© obrigat√≥ria</strong> em toda an√°lise filogen√©tica. Quando as sequ√™ncias em estudo e as caracter√≠sticas do alinhamento s√£o bem conhecidas, o pesquisador pode escolher diretamente um modelo matem√°tico. No entanto, como existem in√∫meros modelos dispon√≠veis, essa escolha pode ser desafiadora, principalmente para iniciantes. No pior cen√°rio, o desconhecimento pode levar √† escolha de um modelo que subestima caracter√≠sticas importantes do alinhamento, resultando em estimativas menos precisas. Por outro lado, incluir muitos par√¢metros aumenta a vari√¢ncia e, consequentemente, a acur√°cia das an√°lises (e, √†s vezes, o poder computacional necess√°rio).</p>
<p>A maioria das ferramentas utiliza o princ√≠pio estat√≠stico da <strong>verossimilhan√ßa (<em>likelihood</em> - L)</strong>. Para isso, calcula-se <strong>L</strong> para todos os modelos dispon√≠veis e depois faz-se uma classifica√ß√£o hier√°rquica (com ou sem crit√©rios de informa√ß√£o). Esses c√°lculos s√£o computacionalmente intensivos, mesmo em muitos computadores atuais.</p>
<hr />
<h2 id="usando-o-mega-x">Usando o MEGA X</h2>
<p>Na sua primeira vers√£o, o programa <strong>MEGA</strong> n√£o possu√≠a op√ß√µes para testar o modelo de substitui√ß√£o. Ainda assim, foi um dos primeiros programas filogen√©ticos a incluir essa funcionalidade nativamente. O algoritmo √© r√°pido, embora teste mais modelos do que est√£o dispon√≠veis na pr√≥pria ferramenta.</p>
<ul>
<li>Utilizaremos o arquivo de alinhamento m√∫ltiplo <a href="https://drive.google.com/uc?export=download&amp;id=1CKutTUK4aAH-yGyZ1fhVfzz07SVVo3dD">vert-aligned.fasta</a>:</li>
<li>Execute o programa <strong>MEGA X</strong>.</li>
<li>Abra o alinhamento clicando no bot√£o <strong>TA</strong> e depois em <strong><em>Open a File/Session...</em></strong> de acordo com a foto abaixo:</li>
</ul>
<p><img alt="MegaX" src="../MTENG-fig1.png" /></p>
<ul>
<li>Na janela seguinte, clique em <strong><em>Analyze</em></strong> (as sequ√™ncias j√° est√£o alinhadas).</li>
</ul>
<p><img alt="Analyze" src="../MTENG-fig2.png" /></p>
<ul>
<li>O MEGA perguntar√° se s√£o sequ√™ncias de nucleot√≠deos. Clique em <code>Ok</code>.</li>
</ul>
<p><img alt="Nucleotide sequences" src="../MTENG-fig3.png" /></p>
<ul>
<li>Perguntar√° se s√£o <strong>sequ√™ncias codificadoras de prote√≠nas</strong> (<em>protein-coding sequences</em>). Clique em <code>Yes</code>.</li>
</ul>
<p><img alt="Coding sequences" src="../MTENG-fig4.png" /></p>
<ul>
<li>Escolha o c√≥digo gen√©tico: <strong><em>Vertebrate Mitochondrial</em></strong>.</li>
<li>Com o arquivo aberto, clique em <strong><em>Models</em></strong>,</li>
</ul>
<p><img alt="Models in MEGA X" src="../MTENG-fig6.png" /></p>
<ul>
<li>e selecione <strong><em>Find Best DNA/Protein Models (ML)...</em></strong>:</li>
</ul>
<p><img alt="best-fit model in Mega X" src="../MTENG-fig7.png" /></p>
<ul>
<li>Confirme o uso do conjunto de dados aberto clicando em <code>Yes</code>:</li>
</ul>
<p><img alt="" src="../MTENG-fig8.png" /></p>
<ul>
<li>Ap√≥s confirma√ß√£o, uma caixa ir√° aparecer. </li>
</ul>
<p><img alt="" src="../MTENG-fig9.png" /></p>
<ul>
<li>Defina as op√ß√µes:</li>
<li><em>Tree to use</em> / √Årvore inicial: <em>Automatic</em> / autom√°tica (<em>Neighbor-Joining</em>).</li>
<li><em>Substitutions Type</em> / Tipo de substitui√ß√µes: <em>Nucleotide</em> / nucleot√≠deos.</li>
<li><em>Gap/Missing data treatment</em> / Subgrupos de dados: <em>Use all sites</em> / todos os s√≠tios -&gt; todas as posi√ß√µes de c√≥dons, sem filtros (<em>Branch-swap filter</em>).</li>
<li><em>Number of threads</em> / N√∫mero de threads: mantenha o padr√£o.</li>
<li>Clique em <code>Ok</code> e aguarde.
Os resultados ir√£o aparecer em uma tabela:</li>
</ul>
<p><img alt="Best-fit models results" src="../MTENG-fig10.png" /></p>
<p>Os modelos ser√£o listados do mais adequado ao menos adequado, com base no crit√©rio <strong><em>BIC (Bayesiano)</em></strong>. Com isso, podemos verificar que o modelo <strong><em>GTR (General Time-reversible)</em></strong> com corre√ß√£o gama <strong>(+G)</strong> foi o modelo escolhido pelo crit√©rio Bayesiano. No entanto, n√£o √© o modelo com a menor verossimilhan√ßa (lnL). O restante das informa√ß√µes dessa tabela ser√° discutido durante a reuni√£o remota.
Exemplo: modelo escolhido ‚Äî <code>GTR+G</code>.</p>
<blockquote>
<p>üìå <strong>Dica:</strong> N√£o se esque√ßa de salvar essa tabela em um dos formatos que o MEGA X oferece, utilizando os √≠cones localizados no canto superior esquerdo da tela.
O MEGA X tamb√©m possui a fun√ß√£o para calcular o melhor modelo de substitui√ß√£o de amino√°cidos. Para isso, basta iniciar as an√°lises com um alinhamento de amino√°cidos e, na caixa de di√°logo, escolher a op√ß√£o correta.</p>
</blockquote>
<hr />
<h2 id="usando-o-jmodeltest">Usando o jModelTest</h2>
<p>O programa jModelTest (<a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=Darriba+D%2C+Taboada+GL%2C+Doallo+R%2C+Posada+D.+2012.+jModelTest+2%3A+more+models%2C+new+heuristics+and+parallel+computing.+Nature+Methods+9(8)%2C+772.">Darriba et al. 2012</a>) √© uma vers√£o estendida do popular programa ModelTest (que era uma rotina executada dentro do programa <em>PAUP</em>.) O programa agora √© aut√¥nomo e muito mais r√°pido ap√≥s a inclus√£o das ferramentas <code>PHYML</code>, <code>ReadSeq</code> e <code>Consense</code> do antigo pacote <a href="http://evolution.genetics.washington.edu/phylip.html">PHYLIP</a>. Al√©m disso, o jModelTest permite a otimiza√ß√£o de √°rvores de base para cada modelo, sele√ß√£o de modelos de acordo com um novo crit√©rio de decis√£o te√≥rico e filogenias m√©dias de modelos. Recentemente, foi lan√ßada uma nova vers√£o aprimorada e mais r√°pida, que serve tanto para sequ√™ncias de DNA quanto de prote√≠nas, o ModelTest-NG (<a href="https://academic.oup.com/mbe/article/37/1/291/5552155">Darriba et al. 2019</a>).</p>
<h3 id="etapas">Etapas:</h3>
<ol>
<li>Baixe e execute o <strong>jModelTest.jar</strong> (Java).  O programa √© um aplicativo Java e √© executado de duas maneiras distintas: linha de comando e GUI (Graphical User Interface).O programa depende da instala√ß√£o de um JDK (Java Development Kit), seja ele o oficial da Oracle ou o OpenJDK.As etapas de instala√ß√£o do JDK dependem do sistema operacional e, portanto, n√£o ser√£o detalhadas aqui neste tutorial. üìå Vers√£o recomendada: <strong>2.1.10</strong><ul>
<li>N√£o confunda <em>JDK</em> com <em>JRE (Java Runtime Environment)</em>, o qual geralmente est√° presente na maioria dos computadores.</li>
</ul>
</li>
</ol>
<p>No Linux, abra o terminal, navegue at√© a pasta onde o jModelTest.jar est√° localizado e digite o comando abaixo:</p>
<p><code>bash
   java -jar jModelTest.jar</code>
    A janela abaixo ir√° aparecer:
2. Clique em <strong>File &gt; Load DNA alignment</strong> e abra <code>vert-aligned.fasta</code>.
    - Usaremos o mesmo arquivo usado anteriormente: vert-aligned.fasta.
3. Clique em <strong>Analysis &gt; Compute likelihood scores</strong> para iniciar a an√°lise.
4. Ser√° exibida uma caixa de di√°logo que permite especificar o n√∫mero de configura√ß√µes de probabilidade, incluindo o n√∫mero de modelos a serem testados. As outras configura√ß√µes s√£o diferentes frequ√™ncias de base (+F), a propor√ß√£o de locais invari√°veis (+I) e a distribui√ß√£o gama (+G) (varia√ß√£o na taxa entre os locais). Nessa caixa de di√°logo, deixe as op√ß√µes como na figura abaixo.
5. Clique em <strong>Compute Likelihoods</strong> e aguarde  (ou v√° tomar um caf√©, pois, dependendo do conjunto de dados, essa etapa levar√° mais tempo do que a executada no MEGA X). Para o alinhamento usado aqui e com essas op√ß√µes, essa etapa levar√° de 1 a 4 minutos.</p>
<pre><code>‚ö†Ô∏è √Ås vezes, dependendo do sistema operacional, voc√™ ter√° de localizar novamente o execut√°vel do programa PhyML. Na janela principal, basta ir a **Edit &gt; Preferences** (Editar &gt; Prefer√™ncias) e localizar novamente o execut√°vel correto para o sistema operacional do computador.

üìå *Antes de continuar, verifique os dados que apareceram no console do jModelTest. Eles tamb√©m ser√£o discutidos na sala, mas s√£o semelhantes aos encontrados no teste do modelo usando o MEGA X.*
</code></pre>
<ol>
<li>Agora, clique novamente no menu <strong>Analysis</strong> (An√°lise). Voc√™ ver√° que os c√°lculos de <em>AIC, BIC e DT</em> agora est√£o dispon√≠veis, enquanto os c√°lculos de hLRT est√£o esmaecidos (porque, na etapa anterior, optamos por ter topologias de √°rvore otimizadas). <ul>
<li>A janela abaixo ir√° aparecer, mostrando as probabilidades calculadas para cada modelo.</li>
</ul>
</li>
<li>V√° em <strong>Results &gt; Show results table</strong> e clique no topo da coluna <code>LnL</code> para ordenar os modelos, de acordo com o likehood. A tabela ir√° parecer com isso:</li>
<li>
<p>A tabela pode mostrar os esquemas de parti√ß√£o, o n√∫mero de par√¢metros inclu√≠dos, as frequ√™ncias de base observadas e as taxas de transi√ß√£o e transvers√£o. Observe que as tabelas dos resultados de AIC, AICc, BIC e DT est√£o em cinza. Para isso, a tabela pode ser fechada e, no menu <strong><em>Analysis</em></strong> (An√°lise), clique em <strong><em>Do BIC calculations...</em></strong> e em <strong><em>Do DT calculations...</em></strong>, confirmando cada caixa de di√°logo que aparecer√° posteriormente, como pode ser verificado na figura abaixo:</p>
</li>
<li>
<p><em>Certifique-se de que as op√ß√µes Calcular importa√ß√µes de par√¢metros e Fazer m√©dia de modelos estejam sempre selecionadas</em></p>
</li>
<li>
<p>Em seguida, vamos para <strong><em>Analysis &gt; Do AIC calculations...</em></strong>. Na caixa, marque a op√ß√£o <strong><em>Use AICc correction (Usar corre√ß√£o AICc)</em></strong>, conforme mostrado na figura abaixo:</p>
<ul>
<li>Voc√™ tamb√©m pode fazer o c√°lculo de Akaike sem a corre√ß√£o para fins de compara√ß√£o. Apenas n√£o selecione a op√ß√£o acima.</li>
</ul>
</li>
<li>
<p>Volte em <strong>Results &gt; Show results table</strong>. Ser√° exibida uma janela mostrando as probabilidades calculadas para cada modelo, com os crit√©rios de informa√ß√£o. Os modelos escolhidos para cada crit√©rio ser√£o marcados em vermelho.</p>
</li>
</ol>
<p>üìå  Para evitar a repeti√ß√£o das an√°lises (o que desperdi√ßa tempo de computa√ß√£o), fa√ßa screeshot da tabela com os resultados finais e salve todo o conte√∫do do console no menu Editar &gt; Salvar console.</p>
<p>Com base nos resultados obtidos, voc√™ observar√° que os resultados convergem, embora com algumas discrep√¢ncias. O modelo GTR+G+I √© o melhor para o crit√©rio de Akaike, mas n√£o √© o melhor para o crit√©rio bayesiano. Ent√£o, qual deles escolher? Vamos discutir.</p>
<hr />
<h2 id="usando-o-prottest">Usando o ProtTest</h2>
<p>O programa <strong>ProtTest</strong> (Darriba et al. 2011) √© um programa muito semelhante ao jModelTest, por√©m espec√≠fico para a escolha dos melhores modelos de substitui√ß√£o para alinhamentos de sequ√™ncias de prote√≠nas.</p>
<p>O Prottest 3 pode ser obtido AQUI e executado da mesma forma que o jModelTest (ele tamb√©m √© um aplicativo Java).</p>
<ul>
<li>O <em>MEGA X</em> tamb√©m tem a fun√ß√£o de calcular o melhor modelo de substitui√ß√£o de amino√°cidos. Para isso, basta iniciar as an√°lises com um alinhamento de amino√°cidos e, na caixa de di√°logo, escolher a op√ß√£o correta.</li>
</ul>
<p>Para demonstrar o funcionamento do ProtTest, usaremos o alinhamento de amino√°cidos <code>COX2_PF0016</code>, um dos exemplos fornecidos com o pr√≥prio programa.</p>
<ol>
<li>Baixe e abra o <strong>ProtTest.jar</strong>.</li>
<li>Clique em <strong>File &gt; Load alignment</strong> e Carregue o arquivo <code>COX2_PF0016</code>.</li>
<li>V√° em <strong>Analysis &gt; Compute likelihood scores</strong>.  Ser√° exibida uma caixa de di√°logo que permite especificar o n√∫mero e os modelos a serem testados, al√©m de algumas outras configura√ß√µes.</li>
<li>Em <strong>Starting Topology</strong> escolha como <strong>Maximum Likelihood</strong> ou deixe a escolha padr√£o <strong>Fixed BioNJ JTT</strong>.</li>
<li>Clique em <strong>Compute</strong> e aguarde.</li>
<li>
<p>Agora voc√™ deve tomar um caf√©. O c√°lculo da probabilidade para modelos de substitui√ß√£o de amino√°cidos √© consideravelmente mais intenso, principalmente devido ao n√∫mero mais significativo de altera√ß√µes poss√≠veis e ao n√∫mero de caracteres envolvidos (20 amino√°cidos).</p>
</li>
<li>
<p>Quando terminar, clique em <strong>Selection &gt; Results</strong> para visualizar os resultados.</p>
<p>Uma diferen√ßa not√°vel entre o ProtTest e o jModelTest √© que os c√°lculos dos crit√©rios de informa√ß√£o est√£o na tabela de resultados. Analise a tabela. Mais informa√ß√µes ser√£o fornecidas em sala de aula.</p>
</li>
</ol>
<h2 id="comparacao-de-resultados">Compara√ß√£o de resultados</h2>
<p>Compare os resultados obtidos para o alinhamento <code>COX2_PF0016</code> no ProtTest e no MEGA X. Para usar esse alinhamento no MEGA, use este arquivo. Abaixo est√° uma tabela com os resultados.</p>
<p>üìå Os crit√©rios (AIC, BIC, etc) j√° est√£o inclu√≠dos na tabela final.</p>
<hr />
<h2 id="usando-o-modeltest-ng">Usando o ModelTest-NG</h2>
<p>O ModelTest-NG √© uma nova vers√£o aprimorada e mais r√°pida do jModelTest, que serve tanto para sequ√™ncias de DNA quanto de prote√≠nas (Darriba et al. 2019). Seu desempenho em conjuntos de dados maiores √© muito melhor, e seus c√°lculos s√£o mais otimizados. No entanto, sua instala√ß√£o nos sistemas Windows e macOS ainda n√£o √© acess√≠vel, especialmente para iniciantes. No Linux, a instala√ß√£o √© relativamente r√°pida. Por esse motivo, veremos apenas uma r√°pida demonstra√ß√£o.</p>
<p>Para isso, vamos usar o mesmo arquivo, usado anteriormente: <code>vert-aligned.fasta.</code></p>
<h3 id="etapas_1">Etapas:</h3>
<ol>
<li>Abra o programa ModelTest-NG.</li>
<li>Clique em <strong>Load MSA</strong> e selecione <code>vert-aligned.fasta</code>.  As caracter√≠sticas de alinhamento ser√£o exibidas.</li>
<li>V√° em <strong>Settings</strong> e voc√™ ver√° as op√ß√µes de teste, semelhantes √†s dos programas anteriores.</li>
<li>
<p>Altere a √Årvore inicial para <strong>Maximum likelihood</strong></p>
</li>
<li>
<p>Clique em <strong>Run</strong>.
Observe como o ModelTest-NG √© mais r√°pido do que suas vers√µes anteriores.
Os resultados s√£o quase os mesmos do jModelTest.</p>
</li>
<li>Agora vamos clicar em Reset e repetir as etapas anteriores para o alinhamento <code>COX2_PF0016</code>. Como esse alinhamento √© de sequ√™ncias de amino√°cidos, n√£o se esque√ßa de marcar na guia Settings a op√ß√£o <em>Protein</em>, pois em nossos testes o ModelTest-NG nem sempre identifica corretamente o tipo de sequ√™ncia. Veja abaixo uma pr√©via do resultado:</li>
</ol>
<hr />
<h2 id="consideracoes-finais">Considera√ß√µes Finais</h2>
<h4 id="que-criterios-devo-usar-para-escolher-o-modelo-de-substituicao"><em>Que crit√©rios devo usar para escolher o modelo de substitui√ß√£o?</em></h4>
<p>Essa n√£o √© uma pergunta trivial. Para infer√™ncias bayesianas, o crit√©rio BIC tende a ser mais apropriado. O AICc √© mais adequado para conjuntos de dados pequenos do que o AIC (sem corre√ß√£o); no entanto, os dois tendem a convergir em conjuntos de dados mais massivos, portanto, sempre recomendamos o uso do AICc. O crit√©rio DT (teoria da decis√£o) deve ser usado com cautela, como recomenda o pr√≥prio manual do jModelTest. Portanto, o AICc e o BIC s√£o os crit√©rios mais confi√°veis. Quando eles convergem (e isso acontece com frequ√™ncia), o problema est√° resolvido. Mesmo sem converg√™ncia, voc√™ estar√° seguro se fizer a an√°lise filogen√©tica tanto com o modelo escolhido pelo AICc quanto com o escolhido pelo BIC.</p>
<h4 id="o-modelo-escolhido-nao-existe-na-ferramenta-que-usarei"><em>O modelo escolhido n√£o existe na ferramenta que usarei</em></h4>
<p>Isso n√£o √© o fim do mundo. H√° muitos modelos, mas tamb√©m h√° muitas sobreposi√ß√µes entre eles. Da√≠ a import√¢ncia de conhecer as caracter√≠sticas de alinhamento e as diferen√ßas de par√¢metros entre os diferentes modelos. Muitas vezes, os modelos selecionados por essas ferramentas t√™m pequenas diferen√ßas. Basta procurar o modelo equivalente ou o mais pr√≥ximo em termos de par√¢metros. A execu√ß√£o do jModelTest apresenta outra vantagem significativa: o console fornece um resumo dos par√¢metros avaliados em cada um dos modelos testados para que voc√™ fa√ßa uma escolha mais adequada. Mesmo assim, nada substituir√° a compreens√£o dos modelos e de seus par√¢metros. √â por isso que alguns filogeneticistas n√£o consideram o teste do modelo uma etapa indispens√°vel.</p>
<h4 id="filogenia-media-de-todos-os-modelos"><em>Filogenia m√©dia de todos os modelos</em></h4>
<p>A filogenia m√©dia de todos os modelos √© uma fun√ß√£o que somente o ModelTest e suas variantes t√™m. Essa fun√ß√£o calcula as filogenias m√©dias dos modelos, que s√£o √°rvores de consenso de todas as √°rvores basais otimizadas. No entanto, atualmente ele depende do pacote PHYLIP para essa fun√ß√£o. Ela pode n√£o funcionar se os nomes dos t√°xons tiverem mais de 10 caracteres (quem j√° usou o PHYLIP sabe como essa limita√ß√£o √© insuport√°vel).</p>
<p>Para obt√™-la, no menu Analysis (An√°lise), clique em <em>Model-averaged Phylogeny</em> (Filogenia com m√©dia de modelo). Ser√° aberta uma janela com as configura√ß√µes, na qual voc√™ deixar√° todas as configura√ß√µes no padr√£o e clicar√° em <code>Run</code> (Executar). O resultado listar√° algumas configura√ß√µes, os modelos e a filogenia m√©dia desses modelos. Esse √© um √≥timo guia, mas deve ser usado com muita cautela.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../satsub-ptbr/" class="btn btn-neutral float-left" title="An√°lise de Satura√ß√£o de Substitui√ß√µes"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../BEAST_ptbr/" class="btn btn-neutral float-right" title="Usando o BEAST">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../satsub-ptbr/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../BEAST_ptbr/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
