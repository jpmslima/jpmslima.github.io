<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="jpmslima" /><link rel="canonical" href="https://jpmslima.github.io/BEAST_ptbr/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Usando o BEAST - Tutoriais BioinfoX</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Usando o BEAST";
        var mkdocs_page_input_path = "BEAST_ptbr.md";
        var mkdocs_page_url = "/BEAST_ptbr/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Tutoriais BioinfoX
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Página Inicial</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../demo/">Representação Computacional de Biomoléculas</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../aboutus/">Sobre o grupo</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutoriais Iniciais de Bioinformática</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basic1/">Inicial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../101/">Introdução a linha de comando UNIX</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../102/">Manipulando dados na CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CLI-Colab/">Introdução a CLI e ao Google Colab</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../103/">Introdução ao GenBank</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../104/">Buscas de Similaridade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../105/">Alinhamento entre pares de sequências</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../106-MSA/">Alinhamento Múltiplo de Sequências</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../107-NCBI-CLI/">NCBI/GenBank via CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../108-BLAST-CLI/">BLAST via CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../109-SQL/">Comandos Básicos em SQL</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../r-colab/">Introdução ao R usando o Google Colab</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../enzima-annot/">Integração de Bancos - Exemplo</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../KEGG/">Explorando Vias Metabólicas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../110-BDs/">Bancos de Dados de Informação Proteica</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../111-Modelagem/">Modelagem Computacional de Proteínas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../112-MEGAX/">Primeiros Passos no MEGA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../113-Genomes/">Navegando por Genomas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../video/">Videoaulas</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Bioinformática Estrutural</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basic2/">Inicial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../slides/">Slides de Acompanhamento</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tools/">Programas e Ferramentas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR1-Visualizacao/">Visualização Computacional de Moléculas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR2-pred/">Informações a partir da estrutura primária</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR22-Epitopos/">Predição de Epítopos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR3-Model1/">Modelagem 101</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR4-Model2/">Modelagem 102</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../STR5-Model3.mkdocs gh-deploy --forcemd">Modeller-CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR6-AlphaFold/">Métodos baseados em IA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR7-MDA/">MDA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR8-Aval/">Avaliação dos Modelos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR9-EM/">EM/CryoEM fitting</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR10-RINs/">RINs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR11-APBS/">APBS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR12-Memb/">Proteínas de Membrana</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR13-Dock1/">Autodock (básico)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR14-Dock2/">Docking</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR15-VS1/">Virtual Screening</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR23-MDIntro/">Introdução a Dinâmica Molecular</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR16-EGB1/">Modelos de Pequenas Moléculas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR17-EGB2/">Análise conformacional</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR18-EGB3/">Docking Automático</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR19-EGB4/">Posicionamento Manual</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR20-EGB5/">Dinâmica Molecular</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR21-EGB6/">VS-2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../comps/">Complements</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Análise Evolucionária de Sequências (Evolução Molecular)</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../satsub-ptbr/">Análise de Saturação de Substituições</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bestfit-ptbr/">Escolha do Modelo de Substituição</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Usando o BEAST</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#objetivos">Objetivos</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#geral">Geral</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#especificos">Específicos</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#observacoes">Observações:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#importando-o-alinhamento">Importando o alinhamento</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#definindo-as-tip-dates-quando-aplicavel">Definindo as Tip Dates (quando aplicável)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#configurando-o-modelo-evolutivo">Configurando o modelo evolutivo</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#configurando-o-modelo-de-relogio-molecular-molecular-clock">Configurando o Modelo de Relógio Molecular (Molecular Clock)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#definindo-os-priors-as-priores">Definindo os priors (as priores)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#definindo-as-opcoes-de-execucao-do-mcmc">Definindo as Opções de Execução do MCMC</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#salvando-e-carregando-os-arquivos-beauti">Salvando e carregando os arquivos BEAUti</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#gerando-o-arquivo-xml-do-beast">Gerando o arquivo XML do BEAST</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#executando-o-beast">Executando o BEAST</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#analisando-o-arquivo-de-log-com-o-tracer">Analisando o arquivo de log com o TRACER</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#resumo-e-visualizacao-das-arvores-geradas">Resumo e Visualização das Árvores Geradas</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Diplomado - UChile</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../Presentation/">Home</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../UC_slides/">Slides</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Material/">Files and References</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../First_Tutorial_ENG/">First Tutorial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Substitution_saturation_ENG/">Analysis of Substitution Saturation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ModelTest_ENG/">Test of the Best-Fit Models</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MEGAX_ENG/">Using MEGAX</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../1st_BEAST/">Using BEAST</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../BEAST%2BEBSP_ENG/">Phylodynamics using EBSP</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../IQTree/">Using IQ-Tree</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Tutoriais BioinfoX</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Análise Evolucionária de Sequências (Evolução Molecular)</li>
      <li class="breadcrumb-item active">Usando o BEAST</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="primeiros-passos-no-beast">Primeiros passos no BEAST</h1>
<h2 id="objetivos">Objetivos</h2>
<h3 id="geral">Geral</h3>
<p>Aprender os primeiros passos para realizar uma análise com o pacote de análise filogenética BEAST.</p>
<h3 id="especificos">Específicos</h3>
<ul>
<li>Importar um arquivo de alinhamento.</li>
<li>Escolha do modelo</li>
<li>Aprender como construir os arquivos XML de entrada usando o BEAUti.</li>
<li>Executar o BEAST pela primeira vez.</li>
<li>Primeiros passos na análise dos arquivos de saída do BEAST.</li>
</ul>
<h3 id="observacoes">Observações:</h3>
<ul>
<li>Este tutorial foi adaptado para o <strong>BEAST2</strong> do <a href="http://beast.community/first_tutorial">Primeiro tutorial</a> disponível na comunidade online do BEAST, <strong>única e exclusivamente para fins educacionais.</strong> <b style="color: red;">Para qualquer propósito, o tutorial original é o que deve ser citado ou referenciado.</b></li>
<li>Parte deste tutorial também pode ser executada com o BEAST1.x. As diferenças entre os recursos e aplicações do BEAST2 e do BEAST1.x podem ser encontradas <a href="http://www.beast2.org/beast-features/">AQUI</a>.</li>
<li>Este tutorial requer um conhecimento básico dos conceitos de filogenia molecular e algumas terminologias usadas na área.</li>
<li>Citação do Programa BEAST:</li>
<li>Bouckaert R, Heled J, Kühnert D, et al. BEAST 2: A Software Platform for Bayesian Evolutionary Analysis. Prlic A, ed. PLoS Comput Biol. 2014;10(4):e1003537-6. doi:10.1371/journal.pcbi.1003537.</li>
</ul>
<blockquote>
<p>📌 <em>BEAST1.x e BEAST2 são agora projetos independentes. Leia atentamente o link listado acima com as diferenças nas funções/análises de ambos os programas.</em></p>
</blockquote>
<h2 id="importando-o-alinhamento">Importando o alinhamento</h2>
<p>O grupo de dados de trabalho inicial será um alinhamento de sequências de tRNA mitocondrial de 6 primatas (5 macacos e 1 gibão como outgroup), <a href="https://drive.google.com/uc?export=download&amp;id=1ChU5EcP_3-c78qUK6Y7VwiMe5bdtYKhm">apes.nex</a>. </p>
<p>O arquivo nexus é muito comum em filogenia e vários programas de alinhamento múltiplo de sequências têm a capacidade de exportar o alinhamento neste formato.
O arquivo nexus é representado abaixo (com linhas truncadas):</p>
<pre><code>#NEXUS
BEGIN DATA;
    DIMENSIONS NTAX=6 NCHAR=768;
    FORMAT MISSING=? GAP=- DATATYPE=DNA;
    MATRIX
    human      AGAAATATGTCTGATAAAAGAGTTACTTTGATAGAGTAAATAATAGGAGC...
    chimp      AGAAATATGTCTGATAAAAGAATTACTTTGATAGAGTAAATAATAGGAGT...
    bonobo     AGAAATATGTCTGATAAAAGAATTACTTTGATAGAGTAAATAATAGGAGT...
    gorilla    AGAAATATGTCTGATAAAAGAGTTACTTTGATAGAGTAAATAATAGAGGT...
    orangutan  AGAAATATGTCTGACAAAAGAGTTACTTTGATAGAGTAAAAAATAGAGGT...
    siamang    AGAAATACGTCTGACGAAAGAGTTACTTTGATAGAGTAAATAACAGGGGT...
;END;

</code></pre>
<p>Para usar este alinhamento na análise com o BEAST, teremos que importá-lo com a ferramenta BEAUti. É uma aplicação gráfica interativa para delinear sua análise e gerar o arquivo de controle (um arquivo XML) usado pelo BEAST para realizar a análise.</p>
<p><img alt="beastST-fig1.png" src="../beastST-fig1.png" />
Este é o ícone do BEAUti. Basta dar um duplo clique para executá-lo.</p>
<p>Uma vez que o BEAUti é executado, uma janela semelhante à de baixo deve aparecer:</p>
<p><img alt="BEAUti" src="../beastST-fig2.png" /></p>
<p>Para carregar o arquivo de alinhamento nexus, você tem duas opções:
* Clique em <code>File</code> e depois em <code>Import Alignment</code>.
* Clique no símbolo <code>+</code> no canto inferior esquerdo da tela.</p>
<p>O BEAUti também pode importar arquivos fasta (desde que as sequências estejam alinhadas) ou arquivos XML do BEAST. No entanto, neste último caso, apenas os dados serão importados, não os parâmetros e configurações da execução.</p>
<p>Uma vez carregado, o alinhamento será exibido em formato de tabela na janela principal:</p>
<p><img alt="BEAUti" src="../beastST-fig3.png" /></p>
<p>Ao clicar duas vezes na linha da tabela, o alinhamento pode ser visualizado (embora não seja bom):</p>
<p><img alt="BEAUti" src="../beastST-fig4.png" /></p>
<p>No topo da janela principal, uma série de abas pode ser observada:</p>
<p><img alt="BEAUti" src="../beastST-fig5.png" /></p>
<p>Cada uma dessas abas possui configurações e opções. Em geral, você deve sempre trabalhar com elas da esquerda para a direita. No entanto, nem todos os guias serão relevantes para todas as análises. Após a aba Partitions, você pode ir para a aba chamada Tip Dates.</p>
<h2 id="definindo-as-tip-dates-quando-aplicavel">Definindo as Tip Dates (quando aplicável)</h2>
<p>A aba <code>Tip Dates</code> é usada para colocar datas para cada uma das taxas em sua análise. Nela, você verá uma tabela com todos os grupos taxonômicos que está analisando. As datas dos táxons (Tip dates) são importantes apenas em alguns casos, por exemplo, quando você está trabalhando com vírus de evolução rápida ou DNA de amostras antigas ou fósseis. No caso desta análise de primatas que estamos realizando neste tutorial, a árvore representa milhões de anos de evolução, então as datas podem ser assumidas como zero. Este é o padrão - todas as taxas têm data zero, e o uso da aba <em>Tip Dates</em> não está selecionado.</p>
<p><img alt="" src="../beastST-fig6.png" /></p>
<h2 id="configurando-o-modelo-evolutivo">Configurando o modelo evolutivo</h2>
<p>Na aba <code>Site Model</code>, você pode ajustar o modelo de evolução molecular (modelo de substituição de nucleotídeos e aminoácidos) aos dados de sequência que você carregou (apes.nex). As opções exatas aparecerão dependendo do tipo de dado que você carregou (nucleotídeos, aminoácidos ou outra forma de dados). As opções que aparecerão após o carregamento dos dados de alinhamento <code>apes.nex</code> são as seguintes:</p>
<p><img alt="" src="../beastST-fig7.png" /></p>
<p>Este tutorial assume que você leu ou estudou os diferentes modelos evolutivos disponíveis. Nesta análise, usaremos o modelo <a href="https://www.ncbi.nlm.nih.gov/pubmed/3934395">HKY</a>.</p>
<blockquote>
<p><em>Em versões anteriores do BEAST (1.7 ou 1.8) é mais fácil escolher as posições dos códons para executar a análise (é necessário um alinhamento baseado em códons). Se você precisar de análise de partição, terá que usar essas versões. No entanto, esses dados são de tRNAs mitocondriais, então essa opção não se aplicaria.</em></p>
</blockquote>
<h2 id="configurando-o-modelo-de-relogio-molecular-molecular-clock">Configurando o Modelo de Relógio Molecular (<em>Molecular Clock</em>)</h2>
<p>Na próxima aba, <code>Clock Model</code>, determinaremos o modelo de relógio molecular que será usado na análise. Ao contrário de muitos outros programas de análise filogenética, o BEAST usa exclusivamente modelos de relógio molecular para que as árvores tenham uma escala de tempo (uma raiz inferida e uma direção no tempo). O modelo mais simples é o <em>"Strict clock"</em> ou padrão de relógio restrito. Tal modelo assume que todos os ramos na árvore têm a mesma taxa de evolução. Outros modelos de relógio molecular relaxam essas suposições de várias maneiras, e outros tutoriais avançados podem ser usados para verificar sua aplicação.</p>
<p><img alt="" src="../beastST-fig8.png" /></p>
<p>Selecione <em>Strict Clock</em> e mude para a aba <code>Priors</code>.</p>
<h2 id="definindo-os-priors-as-priores">Definindo os <em>priors</em> (as priores)</h2>
<p>É neste painel que os priors da análise Bayesiana serão determinados. Na primeira caixa de seleção, você pode colocar o modelo que fornecerá um <code>a priori</code> na árvore para a execução do MCMC.</p>
<p>A priori da árvore (<em>Tree Prior</em>) tem muitas possibilidades, geralmente divididas em modelos coalescentes (<em>Coalescent</em>), que geralmente são adequados para populações, e modelos de especiação (<em>Speciation</em>), que como o nome sugere são direcionados para dados em nível de espécie. </p>
<p>Como o alinhamento que temos é de várias espécies, selecionaremos o modelo de <a href="http://rstb.royalsocietypublishing.org/content/213/402-410/21">Yule</a>, que é o modelo de especiação mais simples, onde se assume que cada linhagem apresentou especiação a uma taxa fixa.</p>
<p><img alt="" src="../beastST-fig9.png" /></p>
<p>Para cada modelo a priori da árvore, os seguintes parâmetros específicos aparecem na janela. Cada parâmetro no modelo possui operadores, que especificam como os parâmetros mudam à medida que o MCMC gira. Para o modelo de Yule, apenas dois parâmetros são necessários: <code>kappa</code> - que significa a tendência de transições-transversões no modelo HKY; e a taxa de nascimento de novas espécies - <code>birthRate</code>.</p>
<p>O BEAST mantém razoavelmente os valores padrão para os priors de cada modelo. Selecionar os priors é um aspecto da análise BEAST que deve ser levado mais a sério. Somente modifique esses parâmetros se tiver certeza do que está fazendo, com conhecimento específico de cada um. No restante deste tutorial, usaremos esses valores padrão, então deixe-os como estão e vá para a aba <code>MCMC</code>.</p>
<h2 id="definindo-as-opcoes-de-execucao-do-mcmc">Definindo as Opções de Execução do MCMC</h2>
<p>Nesta aba, teremos as configurações para executar a análise Bayesiana pelo BEAST.</p>
<p><img alt="" src="../beastST-fig10.png" /></p>
<p>Primeiro temos o comprimento da cadeia (<em>ou referido como o número de gerações</em>). Este é o número de passos que o MCMC fará na cadeia antes de finalizar o processo. Quão longo deve ser depende do tamanho do conjunto de dados, da complexidade do modelo e da qualidade da resposta exigida. Neste caso, o valor padrão é totalmente arbitrário e deve ser ajustado de acordo com o tamanho do conjunto de dados que será analisado. Para verificar se o tamanho da cadeia é adequado, o arquivo de log resultante (<em>arquivo log</em>) pode ser analisado usando o programa <strong>Tracer</strong> (verificaremos isso mais tarde). O objetivo de selecionar um tamanho de cadeia adequado é alcançar um tamanho de amostra efetivo razoável (<em>ESS - Effective Sample Size</em>).</p>
<blockquote>
<p>📌 <em>Maneiras de alcançar um ESS adequado podem ser verificadas em outros tutoriais da <a href="beast.community">comunidade BEAST</a>.</em></p>
</blockquote>
<p>As opções seguintes especificam o quanto tais parâmetros devem ser registrados no arquivo de log <code>tracelog</code> e mostrados na tela <code>screenlog</code>.</p>
<p>Para o <code>tracelog</code>, o valor deve ser relativo ao valor total do tamanho da cadeia. Realizar uma amostragem muito frequente (registro de valor) resultará em arquivos enormes com pouco benefício extra em termos de precisão. Por outro lado, amostrar com pouca frequência resultará em um arquivo de log sem informações suficientes sobre as distribuições dos parâmetros. Normalmente, 10.000 amostragens é um número adequado, e para armazenar isso, basta colocar um número que seja o tamanho da cadeia / 10.000. As outras opções podem ser deixadas com os valores padrão (ressaltando novamente que no BEAST, os padrões são razoáveis).</p>
<p>Para este conjunto de dados (que é bastante pequeno), iniciaremos a análise com um tamanho de cadeia de 1.000.000, pois este valor será executado muito rapidamente na maioria dos computadores atuais. Portanto, coloque o registro de frequência (amostragem) no arquivo de log para 100.</p>
<p><img alt="" src="../beastST-fig11.png" /></p>
<p>A saída da tela é simplesmente para monitorar o progresso da execução do BEAST, então qualquer valor pode ser colocado (no entanto, se você escolher um valor muito pequeno, a quantidade de informação que aparecerá na tela pode tornar o terminal do programa lento).</p>
<p><img alt="" src="../beastST-fig12.png" /></p>
<blockquote>
<p>📌 <em>A frequência de amostragem do log de tela e do log de rastreamento pode ser diferente. Neste caso, nossa análise será executada muito rapidamente, então amostrar o log de tela a cada 100 passos causará um movimento rápido na tela devido a uma grande quantidade de informação.</em></p>
</blockquote>
<p>Para a opção <code>treelog</code>, deixe o mesmo número de amostragem em <code>tracelog</code>.</p>
<p><img alt="" src="../beastST-fig13.png" /></p>
<h2 id="salvando-e-carregando-os-arquivos-beauti">Salvando e carregando os arquivos BEAUti</h2>
<p>Ao selecionar <code>Save</code> no menu <code>File</code>, um arquivo no formato BEAUti será salvo. Note que este não é o formato que o BEAST "entende" - o BEAUti apenas o reabrirá. Desta forma, as configurações e os dados podem ser salvos e carregados posteriormente. Salve os arquivos BEAUti com a extensão <code>.beauti</code>.</p>
<blockquote>
<p><em>Como os arquivos BEAUti não podem ser lidos e "entendidos" pelo BEAST, você não pode abrir os arquivos XML do BEAST diretamente no BEAUti. Se necessário, eles podem ser importados da mesma forma que arquivos FASTA ou NEXUS. Os dados da sequência, as <code>Tip Dates</code> e outras informações serão importados.</em></p>
</blockquote>
<h2 id="gerando-o-arquivo-xml-do-beast">Gerando o arquivo XML do BEAST</h2>
<p>O arquivo XML do BEAST pode agora ser criado. Selecione <code>Save as...</code> no menu <code>File</code> e salve-o com um nome apropriado. Não se esqueça de adicionar a extensão <code>.xml</code>, ao salvar. Em Computadores Agora o arquivo está pronto para ser executado com o BEAST.</p>
<h2 id="executando-o-beast">Executando o BEAST</h2>
<p>Execute o BEAST2 clicando no seguinte ícone:</p>
<p><img alt="beastST-fig14.png" src="../beastST-fig14.png" /></p>
<p>A seguinte janela aparecerá:</p>
<p><img alt="BEAST2 Main Window" src="../beastST-fig15.png" /></p>
<p>A partir de agora, tudo o que você precisa fazer é clicar em <code>Choose File...</code>, selecionar o arquivo XML que você salvou nos passos anteriores e pressionar <code>Run</code>.</p>
<hr />
<p><strong>Usando GPU</strong></p>
<p><em>Para acelerar a análise com conjuntos de dados maiores e/ou tamanhos de cadeia MCMC maiores, a instalação da biblioteca BEAGLE é fortemente recomendada, especialmente se você tiver uma placa de vídeo com suporte CUDA (GPU). No BEAST1.x, a biblioteca BEAGLE pode ser executada diretamente desta janela. Na versão 2, recomenda-se instalar o JAVA JDK e executar o BEAST2 a partir da linha de comando do terminal (em computadores com sistemas baseados em Unix). A configuração da instrução beagle_SSE também acelera drasticamente a análise de computadores com processadores mais recentes. Um exemplo de um comando geral para executar o BEAST2 a partir de um terminal é:</em></p>
<pre><code>/bin/beast -beagle_CPU -beagle_SSE -threads 4 -instances 4 -overwrite nome_do_arquivo.xml
</code></pre>
<p><em>A janela para execução nas versões BEAST1.x é muito semelhante.</em></p>
<hr />
<p>Ao executar, o BEAST (em qualquer versão) carregará o arquivo XML, configurará a análise e a executará sem interação adicional. Começa com o título e os créditos do software. Você verá a tela de saída, com várias informações, semelhante à de baixo:</p>
<p><img alt="" src="../beastST-fig16.png" /></p>
<p>Um pouco mais abaixo, nesta mesma janela, você poderá ver as citações dos modelos usados e o log de tela da cadeia MCMC, com uma estimativa do tempo da análise (unidade de tempo / Milhões de amostras):</p>
<p><img alt="" src="../beastST-fig17.png" /></p>
<p>E no final, um diagnóstico da adequação dos parâmetros da análise ao grupo de dados:</p>
<p><img alt="" src="../beastST-fig18.png" /></p>
<blockquote>
<p><em>Para saber mais sobre as alterações nesses parâmetros, procure a documentação do BEAST. Somente os altere com absoluta certeza do que está fazendo.</em></p>
</blockquote>
<p>Após a execução, o BEAST gera os seguintes arquivos que você usará posteriormente:</p>
<ul>
<li>Arquivo <code>.log</code> (com o log da análise Bayesiana MCMC).</li>
<li>Arquivo <code>.trees</code> (com todas as árvores geradas e registradas).</li>
</ul>
<h2 id="analisando-o-arquivo-de-log-com-o-tracer">Analisando o arquivo de log com o TRACER</h2>
<p>[Tracer]((http://tree.bio.ed.ac.uk/software/tracer/) é um programa para analisar os arquivos gerados pelas execuções Bayesianas MCMC (ou seja, os valores contínuos dos parâmetros amostrados da cadeia). A análise com o <strong>Tracer</strong> é muito detalhada. Para fins de simplicidade neste tutorial, comentaremos apenas sobre os parâmetros reais do tamanho da amostra para verificar se há uma maior necessidade de amostragem ou tamanho de cadeia maior.</p>
<blockquote>
<p><em>O </em><em>Tracer</em><em> é um download separado dos pacotes do BEAST.</em></p>
</blockquote>
<p>Execute o <strong>TRACER</strong> clicando no ícone:</p>
<p><img alt="beastST-fig19.png" src="../beastST-fig19.png" /></p>
<p>Quando aberto, o <strong>Tracer</strong> mostrará a seguinte janela:</p>
<p><img alt="" src="../beastST-fig20.png" /></p>
<p>Para abrir o arquivo de log de rastreamento MCMC (arquivo <code>.log</code>), clique no símbolo <code>+</code> logo abaixo de <code>Trace Files</code> (indicado pela seta na figura acima). Após este passo, uma janela como esta deve ser exibida:</p>
<p><img alt="" src="../beastST-fig21.png" /></p>
<p>Note que a <span style="color:red"><strong><em>Seta 1</em></strong></span> mostrada na figura acima está indicando que o Tracer atribui 10% para <strong><em>Burn-In</em></strong>. Este é o número de passos no início da cadeia que é descartado da análise, que tende a apresentar uma maior variação nos parâmetros.</p>
<blockquote>
<p><em>O descarte ou burn-in de 10% do tamanho total da cadeia é o recomendado. No entanto, isso pode ser alterado. Este valor pode ser aumentado em execuções com tamanhos de cadeia MCMC maiores. docs/MEGAX_ENG.md</em></p>
</blockquote>
<p>Observe os parâmetros destacados pela moldura vermelha. Em todos, os valores na coluna <strong>ESS</strong> (<em>Effective Sample Size</em>) devem estar em preto. Isso demonstra que os valores são adequados para análise. Quando não estão, são marcados nas cores <span style="color:orange">laranja</span>, que indica que estão parcialmente adequados, ou <span style="color:red">vermelho</span>, que indica que não estão adequados. Os parâmetros que devem ser analisados inicialmente são posterior, <em>likelihood</em> e os parâmetros estatísticos do modelo como <em>prior ou YuleModel.</em></p>
<p>Para corresponder às estatísticas dos parâmetros que o ESS está marcado em vermelho, você pode aumentar o tamanho da cadeia e, dependendo do parâmetro, alterações nos priors no arquivo XML com BEAUti devem ser realizadas. A análise desses parâmetros e as indicações de diagnóstico do BEAST ao final de cada execução são fortemente recomendadas.</p>
<p>Clique na <span style="color:red"><strong><em>Seta 2</em></strong></span> e o <strong><em>Trace</em></strong> da execução pode ser observado. A parte cinza no Trace demonstra exatamente o <strong><em>Burn-In</em></strong> empregado na análise, como pode ser visto na figura abaixo:</p>
<p><img alt="" src="../beastST-fig22.png" /></p>
<blockquote>
<p><em>Este mesmo burn-in também será usado ao resumir as árvores da análise Bayesiana.</em></p>
</blockquote>
<p>Finalmente, selecione as estatísticas dos parâmetros posterior e likelihood (usando a tecla <code>ctrl</code> no seu teclado) e clique no local indicado pela <span style="color:red"><strong><em>Seta</em></strong></span>. O <strong>Tracer</strong> retornará um gráfico da distribuição de pontos dos 2 parâmetros, semelhante à figura abaixo:</p>
<p><img alt="" src="../beastST-fig23.png" /></p>
<p>Para maiores detalhes sobre a análise com o <strong>Tracer</strong> e suas outras funções, leituras aprofundadas sobre Inferência Bayesiana, o manual/<em>readme</em> do <strong>Tracer</strong> e a comunidade BEAST são recomendadas.</p>
<h2 id="resumo-e-visualizacao-das-arvores-geradas">Resumo e Visualização das Árvores Geradas</h2>
<p>Agora vamos trabalhar com o arquivo <code>.trees</code>, gerado pelo BEAST. Como descrito anteriormente, este arquivo possui cada árvore gerada e registrada pela análise MCMC. Como tivemos um tamanho de cadeia de 1.000.000 e pedimos para fazer registros a cada 100 (o mesmo que o <code>trace log</code>), teremos um arquivo com 10.000 árvores.</p>
<p>Temos que resumir todas essas árvores, em uma, com os valores de probabilidades <em>a posteriori</em> (PP) em cada nó da árvore. Para isso, usaremos um programa fornecido com o BEAST, chamado <strong>TreeAnnotator</strong>. Para executá-lo, clique em seu respectivo ícone:</p>
<p><img alt="beastST-fig24.png" src="../beastST-fig24.png" /></p>
<p>Uma janela semelhante à de baixo aparecerá:</p>
<p><img alt="" src="../beastST-fig25.png" /></p>
<p>Na caixa <strong><em>Burnin percentage</em></strong>, você colocará a porcentagem de <em>burn-in</em> desta análise, ou seja, as primeiras árvores geradas que serão descartadas da análise por estarem no início da cadeia.</p>
<p>A opção <strong><em>Posterior probability</em></strong> limit serve para evitar a resolução de nós da árvore abaixo do limite de PP inserido neste campo. Por exemplo, se você colocar o limite de 50, nós com menos de 50 PP não serão resolvidos.</p>
<p>Nas opções <strong><em>Target tree type</em></strong> e <strong><em>Node heights</em></strong> escolha as opções demonstradas na figura acima, de <strong><em>Maximum clade credibility tree</em></strong> e <strong><em>Common Ancestor heights</em></strong>, respectivamente.</p>
<p>No campo <strong><em>Input Tree File</em></strong>, você clicará em Choose File... e adicionará o <code>.trees</code> gerado na análise. E no campo <strong><em>Output File</em></strong>, você também clicará em <code>Choose File...</code>, neste caso, você nomeará o arquivo e o inserirá na pasta de sua escolha. Não se esqueça de colocar a extensão <code>.tree</code> no final do nome do arquivo para que os programas de visualização de árvores o reconheçam mais facilmente.</p>
<p>Um programa recomendado para visualização de árvores é o programa <strong>FigTree</strong>, que pode ser obtido <a href="http://tree.bio.ed.ac.uk/software/figtree/">AQUI</a>.</p>
<p>O arquivo <code>.trees</code> gerado também pode ser visualizado com o programa <strong>DensiTree</strong>. Este programa faz uma representação esquemática com todas as árvores, facilitando a análise de inconsistências. <strong>DensiTree</strong> pode ser executado pelo ícone:</p>
<p><img alt="beastST-fig26.png" src="../beastST-fig26.png" /></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../bestfit-ptbr/" class="btn btn-neutral float-left" title="Escolha do Modelo de Substituição"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../Presentation/" class="btn btn-neutral float-right" title="Home">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../bestfit-ptbr/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../Presentation/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
