<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="jpmslima" /><link rel="canonical" href="https://jpmslima.github.io/BEAST_ptbr/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Usando o BEAST - Tutoriais BioinfoX</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Usando o BEAST";
        var mkdocs_page_input_path = "BEAST_ptbr.md";
        var mkdocs_page_url = "/BEAST_ptbr/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Tutoriais BioinfoX
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">P√°gina Inicial</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../demo/">Representa√ß√£o Computacional de Biomol√©culas</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../aboutus/">Sobre o grupo</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutoriais Iniciais de Bioinform√°tica</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basic1/">Inicial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../101/">Introdu√ß√£o a linha de comando UNIX</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../102/">Manipulando dados na CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CLI-Colab/">Introdu√ß√£o a CLI e ao Google Colab</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../103/">Introdu√ß√£o ao GenBank</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../104/">Buscas de Similaridade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../105/">Alinhamento entre pares de sequ√™ncias</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../106-MSA/">Alinhamento M√∫ltiplo de Sequ√™ncias</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../107-NCBI-CLI/">NCBI/GenBank via CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../108-BLAST-CLI/">BLAST via CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../109-SQL/">Comandos B√°sicos em SQL</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../r-colab/">Introdu√ß√£o ao R usando o Google Colab</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../enzima-annot/">Integra√ß√£o de Bancos - Exemplo</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../KEGG/">Explorando Vias Metab√≥licas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../110-BDs/">Bancos de Dados de Informa√ß√£o Proteica</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../111-Modelagem/">Modelagem Computacional de Prote√≠nas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../112-MEGAX/">Primeiros Passos no MEGA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../113-Genomes/">Navegando por Genomas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../video/">Videoaulas</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Bioinform√°tica Estrutural</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basic2/">Inicial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../slides/">Slides de Acompanhamento</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tools/">Programas e Ferramentas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR1-Visualizacao/">Visualiza√ß√£o Computacional de Mol√©culas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR2-pred/">Informa√ß√µes a partir da estrutura prim√°ria</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR22-Epitopos/">Predi√ß√£o de Ep√≠topos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR3-Model1/">Modelagem 101</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR4-Model2/">Modelagem 102</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../STR5-Model3.mkdocs gh-deploy --forcemd">Modeller-CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR6-AlphaFold/">M√©todos baseados em IA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR7-MDA/">MDA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR8-Aval/">Avalia√ß√£o dos Modelos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR9-EM/">EM/CryoEM fitting</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR10-RINs/">RINs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR11-APBS/">APBS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR12-Memb/">Prote√≠nas de Membrana</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR13-Dock1/">Autodock (b√°sico)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR14-Dock2/">Docking</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR15-VS1/">Virtual Screening</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR23-MDIntro/">Introdu√ß√£o a Din√¢mica Molecular</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR16-EGB1/">Modelos de Pequenas Mol√©culas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR17-EGB2/">An√°lise conformacional</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR18-EGB3/">Docking Autom√°tico</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR19-EGB4/">Posicionamento Manual</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR20-EGB5/">Din√¢mica Molecular</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR21-EGB6/">VS-2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../comps/">Complements</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">An√°lise Evolucion√°ria de Sequ√™ncias (Evolu√ß√£o Molecular)</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../satsub-ptbr/">An√°lise de Satura√ß√£o de Substitui√ß√µes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bestfit-ptbr/">Escolha do Modelo de Substitui√ß√£o</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Usando o BEAST</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#objetivos">Objetivos</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#geral">Geral</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#especificos">Espec√≠ficos</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#observacoes">Observa√ß√µes:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#importando-o-alinhamento">Importando o alinhamento</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#definindo-as-tip-dates-quando-aplicavel">Definindo as Tip Dates (quando aplic√°vel)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#configurando-o-modelo-evolutivo">Configurando o modelo evolutivo</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#configurando-o-modelo-de-relogio-molecular-molecular-clock">Configurando o Modelo de Rel√≥gio Molecular (Molecular Clock)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#definindo-os-priors-as-priores">Definindo os priors (as priores)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#definindo-as-opcoes-de-execucao-do-mcmc">Definindo as Op√ß√µes de Execu√ß√£o do MCMC</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#salvando-e-carregando-os-arquivos-beauti">Salvando e carregando os arquivos BEAUti</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#gerando-o-arquivo-xml-do-beast">Gerando o arquivo XML do BEAST</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#executando-o-beast">Executando o BEAST</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#analisando-o-arquivo-de-log-com-o-tracer">Analisando o arquivo de log com o TRACER</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#resumo-e-visualizacao-das-arvores-geradas">Resumo e Visualiza√ß√£o das √Årvores Geradas</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Diplomado - UChile</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../Presentation/">Home</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../UC_slides/">Slides</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Material/">Files and References</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../First_Tutorial_ENG/">First Tutorial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Substitution_saturation_ENG/">Analysis of Substitution Saturation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ModelTest_ENG/">Test of the Best-Fit Models</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MEGAX_ENG/">Using MEGAX</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../1st_BEAST/">Using BEAST</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../BEAST%2BEBSP_ENG/">Phylodynamics using EBSP</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../IQTree/">Using IQ-Tree</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Tutoriais BioinfoX</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">An√°lise Evolucion√°ria de Sequ√™ncias (Evolu√ß√£o Molecular)</li>
      <li class="breadcrumb-item active">Usando o BEAST</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="primeiros-passos-no-beast">Primeiros passos no BEAST</h1>
<h2 id="objetivos">Objetivos</h2>
<h3 id="geral">Geral</h3>
<p>Aprender os primeiros passos para realizar uma an√°lise com o pacote de an√°lise filogen√©tica BEAST.</p>
<h3 id="especificos">Espec√≠ficos</h3>
<ul>
<li>Importar um arquivo de alinhamento.</li>
<li>Escolha do modelo</li>
<li>Aprender como construir os arquivos XML de entrada usando o BEAUti.</li>
<li>Executar o BEAST pela primeira vez.</li>
<li>Primeiros passos na an√°lise dos arquivos de sa√≠da do BEAST.</li>
</ul>
<h3 id="observacoes">Observa√ß√µes:</h3>
<ul>
<li>Este tutorial foi adaptado para o <strong>BEAST2</strong> do <a href="http://beast.community/first_tutorial">Primeiro tutorial</a> dispon√≠vel na comunidade online do BEAST, <strong>√∫nica e exclusivamente para fins educacionais.</strong> <b style="color: red;">Para qualquer prop√≥sito, o tutorial original √© o que deve ser citado ou referenciado.</b></li>
<li>Parte deste tutorial tamb√©m pode ser executada com o BEAST1.x. As diferen√ßas entre os recursos e aplica√ß√µes do BEAST2 e do BEAST1.x podem ser encontradas <a href="http://www.beast2.org/beast-features/">AQUI</a>.</li>
<li>Este tutorial requer um conhecimento b√°sico dos conceitos de filogenia molecular e algumas terminologias usadas na √°rea.</li>
<li>Cita√ß√£o do Programa BEAST:</li>
<li>Bouckaert R, Heled J, K√ºhnert D, et al. BEAST 2: A Software Platform for Bayesian Evolutionary Analysis. Prlic A, ed. PLoS Comput Biol. 2014;10(4):e1003537-6. doi:10.1371/journal.pcbi.1003537.</li>
</ul>
<blockquote>
<p>üìå <em>BEAST1.x e BEAST2 s√£o agora projetos independentes. Leia atentamente o link listado acima com as diferen√ßas nas fun√ß√µes/an√°lises de ambos os programas.</em></p>
</blockquote>
<h2 id="importando-o-alinhamento">Importando o alinhamento</h2>
<p>O grupo de dados de trabalho inicial ser√° um alinhamento de sequ√™ncias de tRNA mitocondrial de 6 primatas (5 macacos e 1 gib√£o como outgroup), <a href="https://drive.google.com/uc?export=download&amp;id=1ChU5EcP_3-c78qUK6Y7VwiMe5bdtYKhm">apes.nex</a>. </p>
<p>O arquivo nexus √© muito comum em filogenia e v√°rios programas de alinhamento m√∫ltiplo de sequ√™ncias t√™m a capacidade de exportar o alinhamento neste formato.
O arquivo nexus √© representado abaixo (com linhas truncadas):</p>
<pre><code>#NEXUS
BEGIN DATA;
    DIMENSIONS NTAX=6 NCHAR=768;
    FORMAT MISSING=? GAP=- DATATYPE=DNA;
    MATRIX
    human      AGAAATATGTCTGATAAAAGAGTTACTTTGATAGAGTAAATAATAGGAGC...
    chimp      AGAAATATGTCTGATAAAAGAATTACTTTGATAGAGTAAATAATAGGAGT...
    bonobo     AGAAATATGTCTGATAAAAGAATTACTTTGATAGAGTAAATAATAGGAGT...
    gorilla    AGAAATATGTCTGATAAAAGAGTTACTTTGATAGAGTAAATAATAGAGGT...
    orangutan  AGAAATATGTCTGACAAAAGAGTTACTTTGATAGAGTAAAAAATAGAGGT...
    siamang    AGAAATACGTCTGACGAAAGAGTTACTTTGATAGAGTAAATAACAGGGGT...
;END;

</code></pre>
<p>Para usar este alinhamento na an√°lise com o BEAST, teremos que import√°-lo com a ferramenta BEAUti. √â uma aplica√ß√£o gr√°fica interativa para delinear sua an√°lise e gerar o arquivo de controle (um arquivo XML) usado pelo BEAST para realizar a an√°lise.</p>
<p><img alt="beastST-fig1.png" src="../beastST-fig1.png" />
Este √© o √≠cone do BEAUti. Basta dar um duplo clique para execut√°-lo.</p>
<p>Uma vez que o BEAUti √© executado, uma janela semelhante √† de baixo deve aparecer:</p>
<p><img alt="BEAUti" src="../beastST-fig2.png" /></p>
<p>Para carregar o arquivo de alinhamento nexus, voc√™ tem duas op√ß√µes:
* Clique em <code>File</code> e depois em <code>Import Alignment</code>.
* Clique no s√≠mbolo <code>+</code> no canto inferior esquerdo da tela.</p>
<p>O BEAUti tamb√©m pode importar arquivos fasta (desde que as sequ√™ncias estejam alinhadas) ou arquivos XML do BEAST. No entanto, neste √∫ltimo caso, apenas os dados ser√£o importados, n√£o os par√¢metros e configura√ß√µes da execu√ß√£o.</p>
<p>Uma vez carregado, o alinhamento ser√° exibido em formato de tabela na janela principal:</p>
<p><img alt="BEAUti" src="../beastST-fig3.png" /></p>
<p>Ao clicar duas vezes na linha da tabela, o alinhamento pode ser visualizado (embora n√£o seja bom):</p>
<p><img alt="BEAUti" src="../beastST-fig4.png" /></p>
<p>No topo da janela principal, uma s√©rie de abas pode ser observada:</p>
<p><img alt="BEAUti" src="../beastST-fig5.png" /></p>
<p>Cada uma dessas abas possui configura√ß√µes e op√ß√µes. Em geral, voc√™ deve sempre trabalhar com elas da esquerda para a direita. No entanto, nem todos os guias ser√£o relevantes para todas as an√°lises. Ap√≥s a aba Partitions, voc√™ pode ir para a aba chamada Tip Dates.</p>
<h2 id="definindo-as-tip-dates-quando-aplicavel">Definindo as Tip Dates (quando aplic√°vel)</h2>
<p>A aba <code>Tip Dates</code> √© usada para colocar datas para cada uma das taxas em sua an√°lise. Nela, voc√™ ver√° uma tabela com todos os grupos taxon√¥micos que est√° analisando. As datas dos t√°xons (Tip dates) s√£o importantes apenas em alguns casos, por exemplo, quando voc√™ est√° trabalhando com v√≠rus de evolu√ß√£o r√°pida ou DNA de amostras antigas ou f√≥sseis. No caso desta an√°lise de primatas que estamos realizando neste tutorial, a √°rvore representa milh√µes de anos de evolu√ß√£o, ent√£o as datas podem ser assumidas como zero. Este √© o padr√£o - todas as taxas t√™m data zero, e o uso da aba <em>Tip Dates</em> n√£o est√° selecionado.</p>
<p><img alt="" src="../beastST-fig6.png" /></p>
<h2 id="configurando-o-modelo-evolutivo">Configurando o modelo evolutivo</h2>
<p>Na aba <code>Site Model</code>, voc√™ pode ajustar o modelo de evolu√ß√£o molecular (modelo de substitui√ß√£o de nucleot√≠deos e amino√°cidos) aos dados de sequ√™ncia que voc√™ carregou (apes.nex). As op√ß√µes exatas aparecer√£o dependendo do tipo de dado que voc√™ carregou (nucleot√≠deos, amino√°cidos ou outra forma de dados). As op√ß√µes que aparecer√£o ap√≥s o carregamento dos dados de alinhamento <code>apes.nex</code> s√£o as seguintes:</p>
<p><img alt="" src="../beastST-fig7.png" /></p>
<p>Este tutorial assume que voc√™ leu ou estudou os diferentes modelos evolutivos dispon√≠veis. Nesta an√°lise, usaremos o modelo <a href="https://www.ncbi.nlm.nih.gov/pubmed/3934395">HKY</a>.</p>
<blockquote>
<p><em>Em vers√µes anteriores do BEAST (1.7 ou 1.8) √© mais f√°cil escolher as posi√ß√µes dos c√≥dons para executar a an√°lise (√© necess√°rio um alinhamento baseado em c√≥dons). Se voc√™ precisar de an√°lise de parti√ß√£o, ter√° que usar essas vers√µes. No entanto, esses dados s√£o de tRNAs mitocondriais, ent√£o essa op√ß√£o n√£o se aplicaria.</em></p>
</blockquote>
<h2 id="configurando-o-modelo-de-relogio-molecular-molecular-clock">Configurando o Modelo de Rel√≥gio Molecular (<em>Molecular Clock</em>)</h2>
<p>Na pr√≥xima aba, <code>Clock Model</code>, determinaremos o modelo de rel√≥gio molecular que ser√° usado na an√°lise. Ao contr√°rio de muitos outros programas de an√°lise filogen√©tica, o BEAST usa exclusivamente modelos de rel√≥gio molecular para que as √°rvores tenham uma escala de tempo (uma raiz inferida e uma dire√ß√£o no tempo). O modelo mais simples √© o <em>"Strict clock"</em> ou padr√£o de rel√≥gio restrito. Tal modelo assume que todos os ramos na √°rvore t√™m a mesma taxa de evolu√ß√£o. Outros modelos de rel√≥gio molecular relaxam essas suposi√ß√µes de v√°rias maneiras, e outros tutoriais avan√ßados podem ser usados para verificar sua aplica√ß√£o.</p>
<p><img alt="" src="../beastST-fig8.png" /></p>
<p>Selecione <em>Strict Clock</em> e mude para a aba <code>Priors</code>.</p>
<h2 id="definindo-os-priors-as-priores">Definindo os <em>priors</em> (as priores)</h2>
<p>√â neste painel que os priors da an√°lise Bayesiana ser√£o determinados. Na primeira caixa de sele√ß√£o, voc√™ pode colocar o modelo que fornecer√° um <code>a priori</code> na √°rvore para a execu√ß√£o do MCMC.</p>
<p>A priori da √°rvore (<em>Tree Prior</em>) tem muitas possibilidades, geralmente divididas em modelos coalescentes (<em>Coalescent</em>), que geralmente s√£o adequados para popula√ß√µes, e modelos de especia√ß√£o (<em>Speciation</em>), que como o nome sugere s√£o direcionados para dados em n√≠vel de esp√©cie. </p>
<p>Como o alinhamento que temos √© de v√°rias esp√©cies, selecionaremos o modelo de <a href="http://rstb.royalsocietypublishing.org/content/213/402-410/21">Yule</a>, que √© o modelo de especia√ß√£o mais simples, onde se assume que cada linhagem apresentou especia√ß√£o a uma taxa fixa.</p>
<p><img alt="" src="../beastST-fig9.png" /></p>
<p>Para cada modelo a priori da √°rvore, os seguintes par√¢metros espec√≠ficos aparecem na janela. Cada par√¢metro no modelo possui operadores, que especificam como os par√¢metros mudam √† medida que o MCMC gira. Para o modelo de Yule, apenas dois par√¢metros s√£o necess√°rios: <code>kappa</code> - que significa a tend√™ncia de transi√ß√µes-transvers√µes no modelo HKY; e a taxa de nascimento de novas esp√©cies - <code>birthRate</code>.</p>
<p>O BEAST mant√©m razoavelmente os valores padr√£o para os priors de cada modelo. Selecionar os priors √© um aspecto da an√°lise BEAST que deve ser levado mais a s√©rio. Somente modifique esses par√¢metros se tiver certeza do que est√° fazendo, com conhecimento espec√≠fico de cada um. No restante deste tutorial, usaremos esses valores padr√£o, ent√£o deixe-os como est√£o e v√° para a aba <code>MCMC</code>.</p>
<h2 id="definindo-as-opcoes-de-execucao-do-mcmc">Definindo as Op√ß√µes de Execu√ß√£o do MCMC</h2>
<p>Nesta aba, teremos as configura√ß√µes para executar a an√°lise Bayesiana pelo BEAST.</p>
<p><img alt="" src="../beastST-fig10.png" /></p>
<p>Primeiro temos o comprimento da cadeia (<em>ou referido como o n√∫mero de gera√ß√µes</em>). Este √© o n√∫mero de passos que o MCMC far√° na cadeia antes de finalizar o processo. Qu√£o longo deve ser depende do tamanho do conjunto de dados, da complexidade do modelo e da qualidade da resposta exigida. Neste caso, o valor padr√£o √© totalmente arbitr√°rio e deve ser ajustado de acordo com o tamanho do conjunto de dados que ser√° analisado. Para verificar se o tamanho da cadeia √© adequado, o arquivo de log resultante (<em>arquivo log</em>) pode ser analisado usando o programa <strong>Tracer</strong> (verificaremos isso mais tarde). O objetivo de selecionar um tamanho de cadeia adequado √© alcan√ßar um tamanho de amostra efetivo razo√°vel (<em>ESS - Effective Sample Size</em>).</p>
<blockquote>
<p>üìå <em>Maneiras de alcan√ßar um ESS adequado podem ser verificadas em outros tutoriais da <a href="beast.community">comunidade BEAST</a>.</em></p>
</blockquote>
<p>As op√ß√µes seguintes especificam o quanto tais par√¢metros devem ser registrados no arquivo de log <code>tracelog</code> e mostrados na tela <code>screenlog</code>.</p>
<p>Para o <code>tracelog</code>, o valor deve ser relativo ao valor total do tamanho da cadeia. Realizar uma amostragem muito frequente (registro de valor) resultar√° em arquivos enormes com pouco benef√≠cio extra em termos de precis√£o. Por outro lado, amostrar com pouca frequ√™ncia resultar√° em um arquivo de log sem informa√ß√µes suficientes sobre as distribui√ß√µes dos par√¢metros. Normalmente, 10.000 amostragens √© um n√∫mero adequado, e para armazenar isso, basta colocar um n√∫mero que seja o tamanho da cadeia / 10.000. As outras op√ß√µes podem ser deixadas com os valores padr√£o (ressaltando novamente que no BEAST, os padr√µes s√£o razo√°veis).</p>
<p>Para este conjunto de dados (que √© bastante pequeno), iniciaremos a an√°lise com um tamanho de cadeia de 1.000.000, pois este valor ser√° executado muito rapidamente na maioria dos computadores atuais. Portanto, coloque o registro de frequ√™ncia (amostragem) no arquivo de log para 100.</p>
<p><img alt="" src="../beastST-fig11.png" /></p>
<p>A sa√≠da da tela √© simplesmente para monitorar o progresso da execu√ß√£o do BEAST, ent√£o qualquer valor pode ser colocado (no entanto, se voc√™ escolher um valor muito pequeno, a quantidade de informa√ß√£o que aparecer√° na tela pode tornar o terminal do programa lento).</p>
<p><img alt="" src="../beastST-fig12.png" /></p>
<blockquote>
<p>üìå <em>A frequ√™ncia de amostragem do log de tela e do log de rastreamento pode ser diferente. Neste caso, nossa an√°lise ser√° executada muito rapidamente, ent√£o amostrar o log de tela a cada 100 passos causar√° um movimento r√°pido na tela devido a uma grande quantidade de informa√ß√£o.</em></p>
</blockquote>
<p>Para a op√ß√£o <code>treelog</code>, deixe o mesmo n√∫mero de amostragem em <code>tracelog</code>.</p>
<p><img alt="" src="../beastST-fig13.png" /></p>
<h2 id="salvando-e-carregando-os-arquivos-beauti">Salvando e carregando os arquivos BEAUti</h2>
<p>Ao selecionar <code>Save</code> no menu <code>File</code>, um arquivo no formato BEAUti ser√° salvo. Note que este n√£o √© o formato que o BEAST "entende" - o BEAUti apenas o reabrir√°. Desta forma, as configura√ß√µes e os dados podem ser salvos e carregados posteriormente. Salve os arquivos BEAUti com a extens√£o <code>.beauti</code>.</p>
<blockquote>
<p><em>Como os arquivos BEAUti n√£o podem ser lidos e "entendidos" pelo BEAST, voc√™ n√£o pode abrir os arquivos XML do BEAST diretamente no BEAUti. Se necess√°rio, eles podem ser importados da mesma forma que arquivos FASTA ou NEXUS. Os dados da sequ√™ncia, as <code>Tip Dates</code> e outras informa√ß√µes ser√£o importados.</em></p>
</blockquote>
<h2 id="gerando-o-arquivo-xml-do-beast">Gerando o arquivo XML do BEAST</h2>
<p>O arquivo XML do BEAST pode agora ser criado. Selecione <code>Save as...</code> no menu <code>File</code> e salve-o com um nome apropriado. N√£o se esque√ßa de adicionar a extens√£o <code>.xml</code>, ao salvar. Em Computadores Agora o arquivo est√° pronto para ser executado com o BEAST.</p>
<h2 id="executando-o-beast">Executando o BEAST</h2>
<p>Execute o BEAST2 clicando no seguinte √≠cone:</p>
<p><img alt="beastST-fig14.png" src="../beastST-fig14.png" /></p>
<p>A seguinte janela aparecer√°:</p>
<p><img alt="BEAST2 Main Window" src="../beastST-fig15.png" /></p>
<p>A partir de agora, tudo o que voc√™ precisa fazer √© clicar em <code>Choose File...</code>, selecionar o arquivo XML que voc√™ salvou nos passos anteriores e pressionar <code>Run</code>.</p>
<hr />
<p><strong>Usando GPU</strong></p>
<p><em>Para acelerar a an√°lise com conjuntos de dados maiores e/ou tamanhos de cadeia MCMC maiores, a instala√ß√£o da biblioteca BEAGLE √© fortemente recomendada, especialmente se voc√™ tiver uma placa de v√≠deo com suporte CUDA (GPU). No BEAST1.x, a biblioteca BEAGLE pode ser executada diretamente desta janela. Na vers√£o 2, recomenda-se instalar o JAVA JDK e executar o BEAST2 a partir da linha de comando do terminal (em computadores com sistemas baseados em Unix). A configura√ß√£o da instru√ß√£o beagle_SSE tamb√©m acelera drasticamente a an√°lise de computadores com processadores mais recentes. Um exemplo de um comando geral para executar o BEAST2 a partir de um terminal √©:</em></p>
<pre><code>/bin/beast -beagle_CPU -beagle_SSE -threads 4 -instances 4 -overwrite nome_do_arquivo.xml
</code></pre>
<p><em>A janela para execu√ß√£o nas vers√µes BEAST1.x √© muito semelhante.</em></p>
<hr />
<p>Ao executar, o BEAST (em qualquer vers√£o) carregar√° o arquivo XML, configurar√° a an√°lise e a executar√° sem intera√ß√£o adicional. Come√ßa com o t√≠tulo e os cr√©ditos do software. Voc√™ ver√° a tela de sa√≠da, com v√°rias informa√ß√µes, semelhante √† de baixo:</p>
<p><img alt="" src="../beastST-fig16.png" /></p>
<p>Um pouco mais abaixo, nesta mesma janela, voc√™ poder√° ver as cita√ß√µes dos modelos usados e o log de tela da cadeia MCMC, com uma estimativa do tempo da an√°lise (unidade de tempo / Milh√µes de amostras):</p>
<p><img alt="" src="../beastST-fig17.png" /></p>
<p>E no final, um diagn√≥stico da adequa√ß√£o dos par√¢metros da an√°lise ao grupo de dados:</p>
<p><img alt="" src="../beastST-fig18.png" /></p>
<blockquote>
<p><em>Para saber mais sobre as altera√ß√µes nesses par√¢metros, procure a documenta√ß√£o do BEAST. Somente os altere com absoluta certeza do que est√° fazendo.</em></p>
</blockquote>
<p>Ap√≥s a execu√ß√£o, o BEAST gera os seguintes arquivos que voc√™ usar√° posteriormente:</p>
<ul>
<li>Arquivo <code>.log</code> (com o log da an√°lise Bayesiana MCMC).</li>
<li>Arquivo <code>.trees</code> (com todas as √°rvores geradas e registradas).</li>
</ul>
<h2 id="analisando-o-arquivo-de-log-com-o-tracer">Analisando o arquivo de log com o TRACER</h2>
<p>[Tracer]((http://tree.bio.ed.ac.uk/software/tracer/) √© um programa para analisar os arquivos gerados pelas execu√ß√µes Bayesianas MCMC (ou seja, os valores cont√≠nuos dos par√¢metros amostrados da cadeia). A an√°lise com o <strong>Tracer</strong> √© muito detalhada. Para fins de simplicidade neste tutorial, comentaremos apenas sobre os par√¢metros reais do tamanho da amostra para verificar se h√° uma maior necessidade de amostragem ou tamanho de cadeia maior.</p>
<blockquote>
<p><em>O </em><em>Tracer</em><em> √© um download separado dos pacotes do BEAST.</em></p>
</blockquote>
<p>Execute o <strong>TRACER</strong> clicando no √≠cone:</p>
<p><img alt="beastST-fig19.png" src="../beastST-fig19.png" /></p>
<p>Quando aberto, o <strong>Tracer</strong> mostrar√° a seguinte janela:</p>
<p><img alt="" src="../beastST-fig20.png" /></p>
<p>Para abrir o arquivo de log de rastreamento MCMC (arquivo <code>.log</code>), clique no s√≠mbolo <code>+</code> logo abaixo de <code>Trace Files</code> (indicado pela seta na figura acima). Ap√≥s este passo, uma janela como esta deve ser exibida:</p>
<p><img alt="" src="../beastST-fig21.png" /></p>
<p>Note que a <span style="color:red"><strong><em>Seta 1</em></strong></span> mostrada na figura acima est√° indicando que o Tracer atribui 10% para <strong><em>Burn-In</em></strong>. Este √© o n√∫mero de passos no in√≠cio da cadeia que √© descartado da an√°lise, que tende a apresentar uma maior varia√ß√£o nos par√¢metros.</p>
<blockquote>
<p><em>O descarte ou burn-in de 10% do tamanho total da cadeia √© o recomendado. No entanto, isso pode ser alterado. Este valor pode ser aumentado em execu√ß√µes com tamanhos de cadeia MCMC maiores. docs/MEGAX_ENG.md</em></p>
</blockquote>
<p>Observe os par√¢metros destacados pela moldura vermelha. Em todos, os valores na coluna <strong>ESS</strong> (<em>Effective Sample Size</em>) devem estar em preto. Isso demonstra que os valores s√£o adequados para an√°lise. Quando n√£o est√£o, s√£o marcados nas cores <span style="color:orange">laranja</span>, que indica que est√£o parcialmente adequados, ou <span style="color:red">vermelho</span>, que indica que n√£o est√£o adequados. Os par√¢metros que devem ser analisados inicialmente s√£o posterior, <em>likelihood</em> e os par√¢metros estat√≠sticos do modelo como <em>prior ou YuleModel.</em></p>
<p>Para corresponder √†s estat√≠sticas dos par√¢metros que o ESS est√° marcado em vermelho, voc√™ pode aumentar o tamanho da cadeia e, dependendo do par√¢metro, altera√ß√µes nos priors no arquivo XML com BEAUti devem ser realizadas. A an√°lise desses par√¢metros e as indica√ß√µes de diagn√≥stico do BEAST ao final de cada execu√ß√£o s√£o fortemente recomendadas.</p>
<p>Clique na <span style="color:red"><strong><em>Seta 2</em></strong></span> e o <strong><em>Trace</em></strong> da execu√ß√£o pode ser observado. A parte cinza no Trace demonstra exatamente o <strong><em>Burn-In</em></strong> empregado na an√°lise, como pode ser visto na figura abaixo:</p>
<p><img alt="" src="../beastST-fig22.png" /></p>
<blockquote>
<p><em>Este mesmo burn-in tamb√©m ser√° usado ao resumir as √°rvores da an√°lise Bayesiana.</em></p>
</blockquote>
<p>Finalmente, selecione as estat√≠sticas dos par√¢metros posterior e likelihood (usando a tecla <code>ctrl</code> no seu teclado) e clique no local indicado pela <span style="color:red"><strong><em>Seta</em></strong></span>. O <strong>Tracer</strong> retornar√° um gr√°fico da distribui√ß√£o de pontos dos 2 par√¢metros, semelhante √† figura abaixo:</p>
<p><img alt="" src="../beastST-fig23.png" /></p>
<p>Para maiores detalhes sobre a an√°lise com o <strong>Tracer</strong> e suas outras fun√ß√µes, leituras aprofundadas sobre Infer√™ncia Bayesiana, o manual/<em>readme</em> do <strong>Tracer</strong> e a comunidade BEAST s√£o recomendadas.</p>
<h2 id="resumo-e-visualizacao-das-arvores-geradas">Resumo e Visualiza√ß√£o das √Årvores Geradas</h2>
<p>Agora vamos trabalhar com o arquivo <code>.trees</code>, gerado pelo BEAST. Como descrito anteriormente, este arquivo possui cada √°rvore gerada e registrada pela an√°lise MCMC. Como tivemos um tamanho de cadeia de 1.000.000 e pedimos para fazer registros a cada 100 (o mesmo que o <code>trace log</code>), teremos um arquivo com 10.000 √°rvores.</p>
<p>Temos que resumir todas essas √°rvores, em uma, com os valores de probabilidades <em>a posteriori</em> (PP) em cada n√≥ da √°rvore. Para isso, usaremos um programa fornecido com o BEAST, chamado <strong>TreeAnnotator</strong>. Para execut√°-lo, clique em seu respectivo √≠cone:</p>
<p><img alt="beastST-fig24.png" src="../beastST-fig24.png" /></p>
<p>Uma janela semelhante √† de baixo aparecer√°:</p>
<p><img alt="" src="../beastST-fig25.png" /></p>
<p>Na caixa <strong><em>Burnin percentage</em></strong>, voc√™ colocar√° a porcentagem de <em>burn-in</em> desta an√°lise, ou seja, as primeiras √°rvores geradas que ser√£o descartadas da an√°lise por estarem no in√≠cio da cadeia.</p>
<p>A op√ß√£o <strong><em>Posterior probability</em></strong> limit serve para evitar a resolu√ß√£o de n√≥s da √°rvore abaixo do limite de PP inserido neste campo. Por exemplo, se voc√™ colocar o limite de 50, n√≥s com menos de 50 PP n√£o ser√£o resolvidos.</p>
<p>Nas op√ß√µes <strong><em>Target tree type</em></strong> e <strong><em>Node heights</em></strong> escolha as op√ß√µes demonstradas na figura acima, de <strong><em>Maximum clade credibility tree</em></strong> e <strong><em>Common Ancestor heights</em></strong>, respectivamente.</p>
<p>No campo <strong><em>Input Tree File</em></strong>, voc√™ clicar√° em Choose File... e adicionar√° o <code>.trees</code> gerado na an√°lise. E no campo <strong><em>Output File</em></strong>, voc√™ tamb√©m clicar√° em <code>Choose File...</code>, neste caso, voc√™ nomear√° o arquivo e o inserir√° na pasta de sua escolha. N√£o se esque√ßa de colocar a extens√£o <code>.tree</code> no final do nome do arquivo para que os programas de visualiza√ß√£o de √°rvores o reconhe√ßam mais facilmente.</p>
<p>Um programa recomendado para visualiza√ß√£o de √°rvores √© o programa <strong>FigTree</strong>, que pode ser obtido <a href="http://tree.bio.ed.ac.uk/software/figtree/">AQUI</a>.</p>
<p>O arquivo <code>.trees</code> gerado tamb√©m pode ser visualizado com o programa <strong>DensiTree</strong>. Este programa faz uma representa√ß√£o esquem√°tica com todas as √°rvores, facilitando a an√°lise de inconsist√™ncias. <strong>DensiTree</strong> pode ser executado pelo √≠cone:</p>
<p><img alt="beastST-fig26.png" src="../beastST-fig26.png" /></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../bestfit-ptbr/" class="btn btn-neutral float-left" title="Escolha do Modelo de Substitui√ß√£o"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../Presentation/" class="btn btn-neutral float-right" title="Home">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../bestfit-ptbr/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../Presentation/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
