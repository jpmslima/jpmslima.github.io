<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="jpmslima" /><link rel="canonical" href="https://jpmslima.github.io/tutoriais/BEAST%2BEBSP/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>BEAST+EBSP - Tutoriais BioinfoX</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "BEAST+EBSP";
        var mkdocs_page_input_path = "BEAST+EBSP.md";
        var mkdocs_page_url = "/tutoriais/BEAST%2BEBSP/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Tutoriais BioinfoX
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Página Inicial</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../aboutus/">Sobre o grupo</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutoriais Iniciais de Bioinformática</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basic1/">Inicial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../101/">Introdução a linha de comando UNIX</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../102/">Manipulando dados na CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../103/">Introdução ao GenBank</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../104/">Buscas de Similaridade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../105/">Alinhamento entre pares de sequências</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../106-MSA/">Alinhamento Múltiplo de Sequências</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../107-NCBI-CLI/">NCBI/GenBank via CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../108-BLAST-CLI/">BLAST via CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../109-SQL/">Comandos Básicos em SQL</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../enzima-annot/">Integração de Bancos - Exemplo</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../110-BDs/">Bancos de Dados de Informação Proteica</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../111-Modelagem/">Modelagem Computacional de Proteínas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../112-MEGAX/">Primeiros Passos no MEGA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../113-Genomes/">Navegando por Genomas</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Bioinformática Estrutural</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basic2/">Inicial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../slides/">Slides de Acompanhamento</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tools/">Programas e Ferramentas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR1-Visualizacao/">Visualização Computacional de Moléculas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR2-pred/">Informações a partir da estrutura primária</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR22-Epitopos/">Predição de Epítopos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR3-Model1/">Modelagem 101</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR4-Model2/">Modelagem 102</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR5-Model3/">Modeller-CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR6-AlphaFold/">Métodos baseados em IA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR7-MDA/">MDA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR8-Aval/">Avaliação dos Modelos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR9-EM/">EM/CryoEM fitting</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR10-RINs/">RINs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR11-APBS/">APBS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR12-Memb/">Proteínas de Membrana</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR13-Dock1/">Autodock (básico)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR14-Dock2/">Docking</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR15-VS1/">Virtual Screening</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR23-MDIntro/">Introdução a Dinâmica Molecular</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR16-EGB1/">Modelos de Pequenas Moléculas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR17-EGB2/">Análise conformacional</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR18-EGB3/">Docking Automático</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR19-EGB4/">Posicionamento Manual</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR20-EGB5/">Dinâmica Molecular</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR21-EGB6/">VS-2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../comps/">Complements</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Diplomado - UChile</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../Presentation/">Home</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../UC_slides/">Slides</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Material/">Files and References</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../First_Tutorial_ENG/">First Tutorial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Substitution_saturation_ENG/">Analysis of Substitution Saturation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ModelTest_ENG/">Test of the Best-Fit Models</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MEGAX_ENG/">Using MEGAX</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../1st_BEAST/">Using BEAST</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../BEAST%2BEBSP_ENG/">Phylodynamics using EBSP</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../IQTree/">Using IQ-Tree</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Tutoriais BioinfoX</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">BEAST+EBSP</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <p><a href="http://www.postgradoquimica.cl/informacion-diplomado-en-bioinformatica-y-biologia-computacional/"><img alt="UChile" src="https://drive.google.com/uc?id=1xeSo8MOvqmgO4q_6lyidauaKOjdTPu3t" /></a></p>
<h1 id="phylogenetics-analysis-with-extended-bayesian-skyline-plots-ebsp-using-beast">Phylogenetics analysis with <em>Extended Bayesian Skyline Plots</em> (EBSP) using BEAST</h1>
<h5 id="diego-gomes-teixeira-phd-and-joao-paulo-m-s-lima-phd-associate-professor">Diego Gomes Teixeira (Ph.D.) and João Paulo M S Lima (Ph.D., Associate Professor)</h5>
<p><em><a href="http://bioinfo.imd.ufrn.br/">Bioinformatics Multidisciplinary Environment - BioME</a>,
Universidade Federal do Rio Grande do Norte.</em></p>
<h2 id="introduction">Introduction</h2>
<p>BEAST is a framework that uses an evolutionary approach based on a Bayesian model, which involves a wide range of analyses, resulting in the inference of one or more phylogenies or family trees. It also includes traditional phylogenies, phylodynamics, and phylogeographic inferences, as well as coalescence analysis of the evolutionary history of a population, usually obtained from a single analysis (<a href="https://www.ncbi.nlm.nih.gov/pubmed/15703244">Drummond et al., 2005</a>; <a href="https://www.ncbi.nlm.nih.gov/pubmed/24722319">Bouckaert et al., 2014</a>).</p>
<p>The demographic history of a population leaves a signature on the genome of current representatives. The reconstruction of this history allows us to gain insights into various evolutionary processes involving population genetics, such as tracing the transmission and spread of a virus. The method for estimating population history from DNA or AA sequences depends only on the coalescing events' time and not exactly on the genealogical relationships between the sequences. For example, coalescence events occurring in rapid succession are indicative of a small gene population size (<a href="https://www.ncbi.nlm.nih.gov/pubmed/21481200">Ho; Shapiro, 2011</a>).  </p>
<p>This tutorial will guide you through a phylogenetic analysis of an alignment of ZIKA virus sequences, sampled during the outbreak period in South America. This tutorial is an adaptation of the study conducted by <a href="https://www.ncbi.nlm.nih.gov/pubmed/27013429">FARIA et al. (2016)</a> which investigated the approximate date of introduction of the virus in the Americas by identifying a possible common ancestor among American and Asian isolates. The aim is to reproduce the results obtained in this study, with a small additional population analysis through an <em>Extended Bayesian Skyline Plot (EBSP)</em>.</p>
<h2 id="beauti">BEAUTi</h2>
<h3 id="loading-the-nexus-file">Loading the NEXUS file</h3>
<p>To load the alignment, select the "<em>Import Alignment</em>" option from the "<em>File</em>" menu. The file <code>Zika.nexus_Tutorial</code> can be downloaded <a href="https://drive.google.com/uc?export=download&amp;id=1AmXKP7hkGh5lXUyx-LSoBjbfrPxDZ5y6">HERE</a> and contains an alignment of 23 Zika Virus sequences.</p>
<p><img alt="Fig1_BEAST.png" src="https://drive.google.com/uc?id=1qgRaqfRJ5PdV-yee_ZZiu4EWIwhkB5TW" />  </p>
<h3 id="adding-the-sampling-date-of-the-sequences">Adding the sampling date of the sequences</h3>
<p>In the top menu, select the <code>Tip Dates</code> tab and then check the Use tip date box. You will have the option to manually add each of the dates in the <strong>Date</strong> field, or you can upload a pre-assembled file containing the list of sequence names and the date, separated by a tab. In this example, we will use this list, clicking on the <code>Guess</code> button and then selecting the <code>read from file</code> field. Then, load the file <a href="https://drive.google.com/uc?export=download&amp;id=1t1rB0GRBd1O4etVYwe-rqYc2dKTyTZnE">Tutorial_ZIKA_tips.dat</a>.</p>
<p><img alt="Fig2_BEAST.png" src="https://drive.google.com/uc?id=13HTXsm7j4-WhQosp5lN5hYZRh3wAoMm2" />  </p>
<h3 id="selecting-the-model">Selecting the model</h3>
<p>In the top menu, select the tab <code>Site Model</code> and the field <strong>Subset Model</strong> change to the option <strong>GTR</strong>.</p>
<p><img alt="Fig3_BEAST.png" src="https://drive.google.com/uc?id=1KDSuCo3qL8v-yQlBWyYf_h7hNp4UVXUw" />  </p>
<h3 id="configuring-the-priors">Configuring the Priors</h3>
<p>In the <code>Priors</code> tab at <strong>Tree.t:Tutorial_ZIKA</strong> select the <strong><em>Coalescent Extended Bayesian Skyline</em></strong> option. Then click the <code>+</code> and select the option <strong>MRCA Prior</strong>. In the box that will appear, set the name of the taxon you want to work in the box <strong>Taxon set label</strong>. In this example, we will give the name of <span style="color:red"><strong>taxon A</strong></span> for the taxon that contains the sequences from South America plus the sequence from French Polynesia, and <span style="color:red"><strong>taxon B</strong></span> for the sequences from South America only.</p>
<p><img alt="Fig4_BEAST.png" src="https://drive.google.com/uc?id=1odpz6cOixUwkgoUoc62ESLUxGHJaWzGY" /></p>
<p><img alt="Fig5_BEAST.png" src="https://drive.google.com/uc?id=1Kwza7tTXMK1BZ-9MTRcIzvhGVEuwwlDL" />   </p>
<h3 id="configuring-discrete-features">Configuring discrete features</h3>
<p>Back to the <code>Partitions</code> tab, let us click the <code>+</code> button located at the bottom of the BEAUTi window and select the option <strong>Add Discrete Trait</strong>. In the resulting box, we will set the name <strong>Locals</strong> in the box <strong>Trait Name</strong>. </p>
<p>The next window will ask for the Trait name for each sequence. In that option, we will put the country of origin of each of the samples. Again we have the option to manually put the country name of one in one or to load a tabulated file containing the sequence name and the country name. In the <code>Guess</code> tab we will select the option <strong>Read from file</strong> and load the file <a href="https://drive.google.com/uc?export=download&amp;id=1k1z4MIelEWTt9nTI672DvAePcgWA3gvL">Tutorial_ZIKA_locals.dat</a></p>
<p><img alt="Fig6_BEAST.png" src="https://drive.google.com/uc?id=1mNDeOxBKhp6oSeJRmbk8n1l26iQp4vCx" /></p>
<p><img alt="Fig7_BEAST.png" src="https://drive.google.com/uc?id=1Sy9C-9dBLvlwZr7w0XrPpgZV7rsPvp7x" /></p>
<h3 id="configuring-the-mcmc">Configuring the MCMC</h3>
<p>In the <code>MCMC</code> tab we will set the <strong>Chain Length</strong> to 50,000,000 and change the values of <strong>Log Every</strong> in the boxes <strong>tracelog</strong>, <strong>treelog.t:Tutorial_ZIKA</strong>, <strong>treeWithTraitLogger.Locals</strong> and <strong>EBSPLogger</strong> to 5,000. </p>
<blockquote>
<p><em>Depending on your computer, this chain size can be considerable, and the program will take a long time running. However, it is necessary for EBSP. If you cannot run it, use the files already run at the end of this tutorial.</em></p>
</blockquote>
<p>After this step, go to <code>File &gt; Save</code> and save the .xml file.</p>
<p><img alt="Fig8_BEAST.png" src="https://drive.google.com/uc?id=1ooD9kOhXw5jP_6ivrtY4PXOpheuE1vS1" /> </p>
<h2 id="beast">BEAST</h2>
<blockquote>
<p><em>Before running BEAST2, we have to install some additional extensions to perform these analyses. We will discuss these steps in a synchronous meeting.</em></p>
</blockquote>
<p>In the BEAST window, in the <strong>BEAST XML FILE</strong> field, we will load the .xml file created by BEAUTi and click Run.</p>
<p><img alt="Fig9_BEAST.png" src="https://drive.google.com/uc?id=1T52C6LWdGNWUXl4NDL6DqhvhSkDnXhtp" />  </p>
<h2 id="tree-annotator">Tree Annotator</h2>
<p>At this stage, we will discard the first trees generated by BEAST from the MCMC. In the <strong>Burnin percentage</strong> box, we will put for the program to remove 10% of the initial trees. In the <strong>Node heights</strong> option, we will select the <strong>Median heights</strong> option, and then we will load the BEAST output, the <code>Locals_tree_with_trait.trees</code>, in the <strong>Input Tree File</strong> field, and define the name of the output file in the <strong>Output File</strong> option.</p>
<p><img alt="Fig10_BEAST.png" src="https://drive.google.com/uc?id=1rXJixtbJ0rFxtQi3qsvigV9Yjn214bna" /> </p>
<h2 id="figtree">FigTree</h2>
<p>In FigTree, load the file <code>Local_tree_with_trait.tree</code>, then adjust the branches.</p>
<p><img alt="Fig11_BEAST.png" src="https://drive.google.com/uc?id=1dU4CBNf3dzI_dzQafNSNj6uqgEDyfiLB" />  </p>
<h2 id="tracer">TRACER</h2>
<p>In the Tracer program, we will load the BEAST log file to access some information from the analysis. Clicking on the <code>+</code> we will load the <code>zika_tutorial.log</code> file. Then, we will select, in the <code>Traces</code> tab, the variables <strong>mrcatime(A)</strong> and <strong>mrcatime(B)</strong>.</p>
<p><img alt="Fig12_BEAST.png" src="https://drive.google.com/uc?id=184yMbPuM4QGTPBuJFKhPkIgVitTSJBMG" /></p>
<p><img alt="Fig13_BEAST.png" src="https://drive.google.com/uc?id=17OsJ_6yzY8l35unGkn39GUSWUf6d6wEY" /></p>
<p>Observe the results.</p>
<h2 id="constructing-the-ebsp-plot">Constructing the EBSP Plot</h2>
<p>Open RStudio (or other R environment) and enter the following code:</p>
<pre><code>plotEBSP(“/File_Folder/EBSP.log&quot;, useHPD=FALSE, log=&quot;y&quot;, xlim=c(0,5))
</code></pre>
<p>Remember to switch the <strong>File_Folder</strong> to the location where you saved the <code>EBSP.log</code> file.</p>
<p><img alt="Fig14_BEAST.png" src="https://drive.google.com/uc?id=1sksW5x23RxcYjJk49tK-ztsVgZ6jEYCf" /></p>
<p>Compare the graph to the tree.</p>
<h2 id="using-the-package-ebspanalyser">Using the package EBSPAnalyser</h2>
<p>The EBSPAnalyser package produces a log file with columns time, mean, median, 95% upper and lower, which you can import in a spreadsheet or to your favorite plot software and use to draw a graph.</p>
<p>To run in Linux/MacOS, open a terminal window and use the follow command:  </p>
<p><code>java -cp $(dir)/beast.jar beast.app.tools.EBSPAnalyser</code></p>
<p>where <code>$(dir)</code> points to the directory where <code>beast.jar</code> is located. A window pops up where you specify the <code>EBSP.log</code> file and some other settings.</p>
<blockquote>
<p><em>Retrieved and adapted from <a href="https://www.beast2.org/ebspanalyser/">Beast2/EBSPAnalyzer</a>.</em></p>
</blockquote>
<h2 id="files-generated-after-the-beast-execution">Files generated after the BEAST execution</h2>
<p>The files generated from the above steps are available at the link below:</p>
<p><a href="https://drive.google.com/uc?export=download&amp;id=19xrCmUwQ94JglHMU5BMjoNEAXRuK_jl6">Tutorial Zika Filogenia.zip</a></p>
<h2 id="references">References</h2>
<ul>
<li>
<p>Bouckaert, R. et al. BEAST 2: A Software Platform for Bayesian Evolutionary Analysis. PLoS Computational Biology, v. 10, n. 4, p. e1003537, 10 abr. 2014.</p>
</li>
<li>
<p>Drummond, A. J. et al. Bayesian coalescent inference of past population dynamics from molecular sequences. Molecular Biology and Evolution, v. 22, p. 1185–1192, 2005.</p>
</li>
<li>
<p>Faria, N. R. et al. Zika virus in the Americas: Early epidemiological and genetic findings. Science (New York, N.Y.), v. 5036, n. March, p. aaf5036, 2016.</p>
</li>
<li>
<p>Ho, S. Y. W.; Shapiro, B. Skyline-plot methods for estimating demographic history from nucleotide sequences. Molecular Ecology Resources, v. 11, p. 423–434, 2011.</p>
</li>
</ul>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
