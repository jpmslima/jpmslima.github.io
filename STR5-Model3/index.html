<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="jpmslima" /><link rel="canonical" href="https://jpmslima.github.io/STR5-Model3/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Modelagem Comparativa de Proteínas 3 - Tutoriais BioinfoX</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Modelagem Comparativa de Prote\u00ednas 3";
        var mkdocs_page_input_path = "STR5-Model3.md";
        var mkdocs_page_url = "/STR5-Model3/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Tutoriais BioinfoX
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Página Inicial</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../demo/">Representação Computacional de Biomoléculas</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../aboutus/">Sobre o grupo</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Tutoriais Iniciais de Bioinformática</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basic1/">Inicial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../101/">Introdução a linha de comando UNIX</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../102/">Manipulando dados na CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CLI-Colab/">Introdução a CLI e ao Google Colab</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../103/">Introdução ao GenBank</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../104/">Buscas de Similaridade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../105/">Alinhamento entre pares de sequências</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../106-MSA/">Alinhamento Múltiplo de Sequências</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../107-NCBI-CLI/">NCBI/GenBank via CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../108-BLAST-CLI/">BLAST via CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../109-SQL/">Comandos Básicos em SQL</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../r-colab/">Introdução ao R usando o Google Colab</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../enzima-annot/">Integração de Bancos - Exemplo</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../KEGG/">Explorando Vias Metabólicas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../110-BDs/">Bancos de Dados de Informação Proteica</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../111-Modelagem/">Modelagem Computacional de Proteínas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../112-MEGAX/">Primeiros Passos no MEGA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../113-Genomes/">Navegando por Genomas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../video/">Videoaulas</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Bioinformática Estrutural</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../basic2/">Inicial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../slides/">Slides de Acompanhamento</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../tools/">Programas e Ferramentas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR1-Visualizacao/">Visualização Computacional de Moléculas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR2-pred/">Informações a partir da estrutura primária</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR22-Epitopos/">Predição de Epítopos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR3-Model1/">Modelagem 101</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR4-Model2/">Modelagem 102</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../STR5-Model3.mkdocs gh-deploy --forcemd">Modeller-CLI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR6-AlphaFold/">Métodos baseados em IA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR7-MDA/">MDA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR8-Aval/">Avaliação dos Modelos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR9-EM/">EM/CryoEM fitting</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR10-RINs/">RINs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR11-APBS/">APBS</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR12-Memb/">Proteínas de Membrana</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR13-Dock1/">Autodock (básico)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR14-Dock2/">Docking</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR15-VS1/">Virtual Screening</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR23-MDIntro/">Introdução a Dinâmica Molecular</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR16-EGB1/">Modelos de Pequenas Moléculas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR17-EGB2/">Análise conformacional</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR18-EGB3/">Docking Automático</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR19-EGB4/">Posicionamento Manual</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR20-EGB5/">Dinâmica Molecular</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../STR21-EGB6/">VS-2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../comps/">Complements</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Análise Evolucionária de Sequências (Evolução Molecular)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="../satsub-ptbr.md">Análise de Saturação de Substituições</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../bestfit-ptbr.md">Escolha do Modelo de Substituição</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Diplomado - UChile</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../Presentation/">Home</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../UC_slides/">Slides</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Material/">Files and References</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../First_Tutorial_ENG/">First Tutorial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Substitution_saturation_ENG/">Analysis of Substitution Saturation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ModelTest_ENG/">Test of the Best-Fit Models</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MEGAX_ENG/">Using MEGAX</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../1st_BEAST/">Using BEAST</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../BEAST%2BEBSP_ENG/">Phylodynamics using EBSP</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../IQTree/">Using IQ-Tree</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Tutoriais BioinfoX</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Modelagem Comparativa de Proteínas 3</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="modelagem-comparativa-de-proteinas-3">Modelagem Comparativa de Proteínas 3</h1>
<p>Exemplo de modelagem básica utilizando o Modeller em linha de comando. A utilização do Modeller desta forma traz inúmeras funções e possibilidades de modelagem adicionais, que não são possíveis em sua interface com o UCSF Chimera. </p>
<h3 id="observacoes">Observações:</h3>
<ul>
<li>Este tutorial foi traduzido e adaptado dos tutoriais do programa Modeller (Andrej Sali - <a href="https://salilab.org/modeller/">https://salilab.org/modeller/</a>).</li>
<li>Para instalar o Modeller, baixe o arquivo para a sua versão de sistema operacional e siga as instruções descritas <a href="https://salilab.org/modeller/download_installation.html">AQUI</a>.</li>
</ul>
<p>Após a instalação, verifique o arquivo <em>config.py</em>, dentro do diretório <em>../modeller9.XX/modlib/modeller</em> (Em sistemas Ubuntu, quando instalado pelo comando:</p>
<pre><code>$ sudo apt-get install modeler
</code></pre>
<p>O diretório de instalação é <em>/usr/lib/modeller9.XX/modlib/modeller</em>. Dentro deste diretório, o arquivo <em>config.py</em> deve conter as seguintes linhas:</p>
<pre><code>install_dir = r'/usr/lib/modeller9.XX'
license = 'MODELIRANJE'
</code></pre>
<p><strong>Importante:</strong></p>
<p>Esta licença é exclusivamente didática-acadêmica e deve ser requisitada por todos que utilizam ou utilizarão o programa. A licença pode ser requisitada <a href="https://salilab.org/modeller/registration.html">AQUI</a>. Normalmente um e-mail institucional é necessário.</p>
<ul>
<li>Não esqueça de abrir e editar os scripts abaixo quando necessário (e vai ser necessário), utilizando um editor de texto simples.</li>
<li>Os arquivos necessários estão no arquivo <strong>basic_model.zip</strong>, colocado na página do curso ou podem ser obtidos diretamente [AQUI].</li>
</ul>
<h3 id="modelagem-de-uma-sequencia-com-alta-identidadesimilaridade-a-um-molde">Modelagem de uma sequência com alta identidade/similaridade a um molde</h3>
<p>Modelando a enzima abaixo:</p>
<pre><code>&gt;P1
MSEAAHVLITGAAGQIGYILSHWIASGELYGDRQVYLHLLDIPPAMNRLTALTMELEDCAFPHLAGFVATTDPKA
AFKDIDCAFLVASMPLKPGQVRADLISSNSVIFKNTGEYLSKWAKPSVKVLVIGNPDNTNCEIAMLHAKNLKPEN
FSSLSMLDQNRAYYEVASKLGVDVKDVHDIIVWGNHGESMVADLTQATFTKEGKTQKVVDVLDHDYVFDTFFKKI
GHRAWDILEHRGFTSAASPTKAAIQHMKAWLFGTAPGEVLSMGIPVPEGNPYGIKPGVVFSFPCNVDKEGKIHVV
EGFKVNDWLREKLDFTEKDLFHEKEIALNHLAQGG
</code></pre>
<ul>
<li>Obtenha informações desta enzima, utilizando a ferramenta BLAST do banco de dados <a href="http://www.uniprot.org/">UNIPROT</a>.</li>
</ul>
<h3 id="um-pequeno-historico"><em>Um pequeno histórico</em></h3>
<p>A enzima <em>Trichomonas vaginalis</em> apresenta uma forma da enzima lactato desidrogenase (TvLDH) que possui alta similaridade a enzima malato desidrogenase (TvMDH) da mesma espécie. Esta similaridade é muitas vezes maior que a similaridade com lactato desidrogenases de outros organismos. Devido a este fato, levanta-se a hipótese de que a TvLDH se originou a partir da TvMDH por convergência evolutiva relativamente recente. </p>
<p>Faremos assim, a construção de modelos comparativos para a TvLDH e TvMDH para estudar as sequências em seu contexto estrutural.</p>
<h3 id="procurando-por-estruturas-relacionadas-a-tvldh">Procurando por estruturas relacionadas a TvLDH</h3>
<p>O primeiro passo é colocar a sequência fasta acima no formato PIR (<em>Protein Information Resource</em>). Este formato permite a inserção de informações adicionais às sequências.</p>
<pre><code>&gt;P1;TvLDH
sequence:TvLDH:::::::0.00: 0.00
MSEAAHVLITGAAGQIGYILSHWIASGELYGDRQVYLHLLDIPPAMNRLTALTMELEDCAFPHLAGFVATTDPKA
AFKDIDCAFLVASMPLKPGQVRADLISSNSVIFKNTGEYLSKWAKPSVKVLVIGNPDNTNCEIAMLHAKNLKPEN
FSSLSMLDQNRAYYEVASKLGVDVKDVHDIIVWGNHGESMVADLTQATFTKEGKTQKVVDVLDHDYVFDTFFKKI
GHRAWDILEHRGFTSAASPTKAAIQHMKAWLFGTAPGEVLSMGIPVPEGNPYGIKPGVVFSFPCNVDKEGKIHVV
EGFKVNDWLREKLDFTEKDLFHEKEIALNHLAQGG*
</code></pre>
<p><em>Clique <a href="https://salilab.org/modeller/9v8/manual/node454.html">AQUI</a> para saber mais informações sobre o formato .pir.</em></p>
<h3 id="busca-por-sequencias-relacionadas-de-estrutura-conhecida-pdb">Busca por sequências relacionadas de estrutura conhecida (pdb).</h3>
<p>É realizado pelo comando <strong>profile.build()</strong> do MODELLER. Este conjunto de instruções está descrito no script <em>build_profile_.py</em>. Ele faz o seguinte:</p>
<ol>
<li>
<p>Inicializa o <em>‘environment’</em> para a modelagem, criando um objeto ‘environ’.</p>
</li>
<li>
<p>Cria um objeto ‘sequence_db’, chamando-o de ‘sdb’. Estes objetos são utilizados para conter grandes bancos de dados de sequências proteicas.</p>
</li>
<li>
<p>Lê um arquivo de texto contendo sequências não redundantes do PDB a 95% de identidade para o banco sdb. Para isto há necessidade de um arquivo, <em>pdb_95.pir</em> fornecido na página do MODELLER. Este arquivo também está no formato PIR, e nele, sequências com que possuem menos de 30 ou mais que 4000 resíduos são descartadas, e os resíduos “não-padrão” são removidos.</p>
</li>
<li>
<p>Escreve um arquivo binário contendo todas as sequências lida na etapa anterior.</p>
</li>
<li>
<p>Lê o arquivo binário. <em>Nota: Se o plano é utilizar o banco várias vezes, as duas primeiras etapas só precisam ser realizadas na primeira vez, para produzir o banco binário. Nas corridas subsequentes, estas duas etapas podem ser omitidas.</em></p>
</li>
<li>
<p>Cria um novo objeto ‘alignment’, chamando-o ‘aln’, lê a sequência <em>query</em> TvLDH do arquivo “TvLDH.ali”, e o converte para um perfil (chamaremos <em>profile</em>) ‘prf’. Os Profiles contêm informações similares ao alinhamento, mas são mais compactos e melhores para busca em banco de dados de sequências.</p>
</li>
<li>
<p>Procura dentro do banco ’sdb’ o profile quero criado. Daí os <em>matches</em> do banco são adicionados ao perfil.
h. Escreve um profile da sequência <em>query</em> e seus homólogos/similares em dois formatos: ali (pir) e ‘prf’.</p>
</li>
</ol>
<pre><code class="language-py">from modeller import *

log.verbose()
env = environ()

#-- Prepare the input files

#-- Read in the sequence database
sdb = sequence_db(env)
sdb.read(seq_database_file='pdb_95.pir', seq_database_format='PIR',
         chains_list='ALL', minmax_db_seq_len=(30, 4000), clean_sequences=True)

#-- Write the sequence database in binary form
sdb.write(seq_database_file='pdb_95.bin', seq_database_format='BINARY',
          chains_list='ALL')

#-- Now, read in the binary database
sdb.read(seq_database_file='pdb_95.bin', seq_database_format='BINARY',
         chains_list='ALL')

#-- Read in the target sequence/alignment
aln = alignment(env)
aln.append(file='TvLDH.ali', alignment_format='PIR', align_codes='ALL')

#-- Convert the input sequence/alignment into
#   profile format
prf = aln.to_profile()

#-- Scan sequence database to pick up homologous sequences
prf.build(sdb, matrix_offset=-450, rr_file='${LIB}/blosum62.sim.mat',
          gap_penalties_1d=(-500, -50), n_prof_iterations=1,
          check_profile=False, max_aln_evalue=0.01)

#-- Write out the profile in text format
prf.write(file='build_profile.prf', profile_format='TEXT')

#-- Convert the profile back to alignment format
aln = prf.to_alignment()

#-- Write out the alignment file
aln.write(file='build_profile.ali', alignment_format='PIR')
</code></pre>
<p>Usando a linha de comando, execute:</p>
<pre><code class="language-shell">$ mod9.20 build_profile.py 
</code></pre>
<blockquote>
<p><strong>Nota:</strong> <em>Se outra versão do Modeller for utilizada, apenas trocar o número.</em> </p>
</blockquote>
<p>O comando <strong>profile.build(  )</strong> (<code>prf.build()</code>) tem muitas opções. Neste exemplo <code>rr_file</code> está ajustado para usa a matriz BLOSUM62. Os parâmetros <code>matrix_offset</code> e <code>gap_penalties_1d</code> estão ajustados para valores apropriados para a esta matriz. Ainda, neste exemplo, apenas uma iteração será realizada, ajustando o parâmetro <code>n_prof_iterations</code> em 1. Portanto, não há necessidade de checar o desvio de profile (<code>check_profile</code> ajustado para FALSE). Finalmente, o parâmetro <code>max_aln_evalue</code> está ajustado para 0.01, que é relativo ao <em>E-value</em> de corte para inclusão no profile. Note que, este valor deve ser ajustado de acordo com o caso da modelagem.</p>
<h3 id="selecionando-os-moldes-templates">Selecionando os Moldes (<em>templates</em>)</h3>
<p>Procure por erros e avisos no arquivo de log <code>build-profile.log</code>. Caso não exista, abra em um editor de texto o arquivo de profile <code>build_profile.prf</code>. Verifique os resultados. As 6 primeiras linhas comentadas indicam os parâmetros de <em>input</em> utilizados. O restante são as similaridades. As colunas mais importantes são:</p>
<ul>
<li>
<p>A 2a (código do PDB do banco comparada).</p>
</li>
<li>
<p>A 11a (percentagem de identidade entre a TvLDH e a sequência do pdb, normalizados pelo comprimento do alinhamento).</p>
</li>
<li>
<p>12a (<em>E-value</em> do alinhamento).</p>
</li>
</ul>
<p>Deste arquivo, escolhemos 6 sequências, cujo alinhamento retornou <em>E-value</em> igual a 0.0:</p>
<ul>
<li><strong>1bdm:A, 5mdh:A, 1b8p:A, 1civ:A, 7mdh:A, and 1smk:A</strong></li>
</ul>
<blockquote>
<p><em>Todos podem ser utilizados, mas dentre eles há algum mais adequado para ser utilizado na modelagem?</em></p>
</blockquote>
<p>Para selecionar o molde mais apropriado dentre as 6 estruturas acima, nós utilizaremos o comando <code>alignment.compare_structures()</code> para avaliar a similaridade estrutural e de sequência entre os moldes, utilizando o script <em>compare.py</em>. Abra o arquivo em um editor de texto.</p>
<p>Nesta etapa, você já deverá ter todos os 6 arquivos PDBs escolhidos na etapa acima. O objeto ‘aln’ é criado e o Python é utilizado para instruir o MODELLER a ler cada um dos PDBs. O argumento <code>model_segment</code> é utilizado para retirar apenas cadeias únicas de cada PDB. Depois o <code>append_model</code> é utilizado para adicionar a estrutura ao alinhamento.</p>
<p>Agora, todas as estruturas estão no alinhamento, mas elas não estão alinhadas idealmente uma as outras. Então, o programa <strong>malign</strong> será utilizado para calcular um alinhamento 3D. O comando <strong>malign3d</strong> realiza uma superposição iterativa (<em>least-squares</em>) das estruturas 3D, usando o alinhamento múltiplo como ponto de partida. O comando <code>compare_structures</code> compara as estruturas de acordo com o alinhamento construído pelo malign3D, calculando os desvios RMS e o DRMS entre as posições atômicas e distâncias, diferenças entre os ângulos  da cadeia principal e das cadeias laterais, percentagem de identidade das sequências, etc. Finalmente, o comando <code>id_table</code> escreve um arquivo com distâncias par-a-par das sequências que podem ser utilizadas diretamente como input para o comando <code>dendrogram</code>, que calcula uma árvore de clusterização.</p>
<p>Para isso, rode:</p>
<pre><code class="language-shell">$ mod9.20 compare.py
</code></pre>
<p>Agora abra o arquivo <strong>compare.log</strong> em um editor de texto e o verifique com atenção.</p>
<p><strong>A escolha neste caso:</strong></p>
<ul>
<li>A comparação demonstra que 1civ:A e 7mdh:A são muito similares, tanto em sequência, como em estrutura. No entanto, 7mdh:A tem uma resolução cristalográfica melhor (2.4 verso 2.8 Å), o que elimina 1civ:A. Um segundo grupo de estruturas (5mdh, 1bdm e 1b8p) compartilham algumas similaridades. A partir deste grupo, 5mdh tem a pior resolução e portanto é excluído, deixando apenas 1bdm e 1b8p). 1smk é a estrutura mais diversa deste grupo de possíveis moldes. No entanto, é o único com a menor identidade de sequência a query (34%). Finalmente, 1bdm é escolhida em relação a 1b8p e 7mdh porque possui um Fator-R cristalográfico melhor (16.9%) e maior similaridade a query (45%).</li>
</ul>
<blockquote>
<p><em>A estrutura da TvLDH foi discutida em uma publicação de 2016 (<a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=26889885">Steindel et al. 2016</a>) e está sob o código <a href="https://www.rcsb.org/structure/4UUM">4UUM</a>. Continuaremos com o tutorial como se ela não tivesse sido resolvida (utilizando bancos anteriores do pdb) e no final iremos comparar os modelos obtidos com a estrutura dela.</em></p>
</blockquote>
<h3 id="alinhando-tvldh-com-o-molde">Alinhando TvLDH com o molde</h3>
<p>Como temos apenas um molde, usaremos o comando <code>align2d()</code> no MODELLER. Apesar dele usar um algoritmo de programação dinâmica, ele é diferente de outros métodos-padrão de alinhamento porque leva em conta a informação estrutural no molde quando construindo um alinhamento. Esta tarefa é alcançada por meio de função de <em>GAP Penalty</em> variável que tende a colocar <em>gaps</em> em regiões curvas ou expostas ao solvente, fora de segmentos de estrutura secundária, e entre duas posições que estão perto em espaço. Como resultado, os erros de alinhamento são reduzidos 1/3. Esta melhora no alinhamento se torna ainda mais imprescindível quando a similaridade entre as sequências decresce e o número de <em>gaps</em> aumenta. Neste exemplo a similaridade é alta e qualquer método de alinhamento com parâmetros razoáveis resultaria no mesmo alinhamento ou em um muito próximo. Verifique o script <strong>align2d.py</strong>, que realiza este alinhamento.</p>
<pre><code class="language-py">from modeller import *

env = environ()
aln = alignment(env)
mdl = model(env, file='1bdm', model_segment=('FIRST:A','LAST:A'))
aln.append_model(mdl, align_codes='1bdmA', atom_files='1bdm.pdb')
aln.append(file='TvLDH.ali', align_codes='TvLDH')
aln.align2d()
aln.write(file='TvLDH-1bdmA.ali', alignment_format='PIR')
aln.write(file='TvLDH-1bdmA.pap', alignment_format='PAP')
</code></pre>
<p>Neste, um objeto <code>environ</code> é criado como <em>input</em> para os comandos posteriores. Cria-se um alinhamento vazio ‘aln’ e então um novo modelo proteico ‘mdl’, no qual é lido a cadeia A do arquivo PDB <strong>1bdm</strong>. O comando <code>append_model()</code> transfere a sequência PDB deste modelo para o alinhamento e atribui o nome “1bdmA” (align_codes). Daí a sequência TvLDH também é inserida. O comando <code>align2d()</code> é então executado para alinhar as duas sequências. O alinhamento é escrito em 2 formatos, PIR (TvLDH-1bdmA.ali) e PAP (TvLDH-1bdmA.pap). O formato PIR será usado pelo MODELLLER, e o PAP é para facilitar a inspeção visual pelo usuário.</p>
<p>Executar:</p>
<pre><code class="language-shell">$ mod9.20 align2d.py
</code></pre>
<h3 id="construcao-do-modelo">Construção do Modelo</h3>
<p>Uma vez o alinhamento alvo-molde é construído, o MODELLER calcula um modelo #D do alvo de forma completamente automática, utilizando a classe <code>automodel</code>. O script abaixo irá gerar 5 modelos similares a TvLDH baseado no molde <strong>1bdm:A</strong> e no seu alinhamento.
Script <strong>model-single.py</strong>:</p>
<pre><code class="language-py">from modeller import *
from modeller.automodel import *
from modeller import soap_protein_od

env = environ()
a = automodel(env, alnfile='TvLDH-1bdmA.ali',
              knowns='1bdmA', sequence='TvLDH',
              assess_methods=(assess.DOPE,
                              soap_protein_od.Scorer(),
                              assess.GA341))
a.starting_model = 1
a.ending_model = 5
a.make()
</code></pre>
<p>A primeira linha carrega a classe <code>automodel</code> e a prepara para uso. Um objeto <code>automodel ‘a’</code> é criado, e parâmetros para guiar o processo de construção do modelo são ajustados. <code>alnfile</code> indica o arquivo do alinhamento alvo-molde no formato PIR. <code>knowns</code> define a estrutura do molde conhecida no arquivo <strong>alnfile</strong> (TvLDH-1bdma.ali). <code>sequence</code> define o nome da sequência alvo no <strong>alnfile</strong>. <code>assess_methods</code> requer um ou mais escores de avaliação. <code>starting_model</code> e <code>ending_model</code> definem o número de modelos que serão calculados. A última linha <code>make</code> é a que calcula os modelos.</p>
<p>Executar:</p>
<pre><code class="language-shell">$ mod9.20 model-single.py
</code></pre>
<p>O arquivo de saída mais importante é o <strong>model-single.log</strong>, o qual reporta aviso, erros, e outras informações importantes, incluindo as restrições de entrada para a modelagem que permaneceram violadas no modelo final. As últimas linhas dão um sumário de todos os modelos construídos e alguns escores de avaliação básicos.</p>
<p>Arquivo <em>model-single.log</em></p>
<pre><code>&gt;&gt; Summary of successfully produced models:
Filename                          molpdf     DOPE score    GA341 score
----------------------------------------------------------------------
TvLDH.B99990001.pdb           1763.56104   -38079.76172        1.00000
TvLDH.B99990002.pdb           1560.93396   -38515.98047        1.00000
TvLDH.B99990003.pdb           1712.44104   -37984.30859        1.00000
TvLDH.B99990004.pdb           1720.70801   -37869.91406        1.00000
TvLDH.B99990005.pdb           1840.91772   -38052.00781        1.00000
</code></pre>
<h3 id="avaliacao-inicial-dos-modelos">Avaliação Inicial dos Modelos</h3>
<p>Se mais de um modelo foi gerado para o mesmo alvo, o <em>melhor</em> modelo pode ser selecionado de várias maneiras. A etapa de avaliação de um modelo é uma das mais importantes e será expandida posteriormente utilizando vários outros escores.</p>
<p>Utilizando apenas os dados desta modelagem, você pode escolher o modelo com menor valor da função objetiva do MODELLER (molpdf), ou dos escores de avaliação DOPE ou SOAP, ou o modelo com o escore GA341 mais alto. Os escores adicionais só serão calculados se as linhas relativas a eles no script <em>model-single.py</em> forem desmarcadas (<em>uncommented</em>). O escore SOAP precisa de arquivos adicionais. Todos eles não são medidas absolutas.</p>
<p>Antes de avaliar os modelos em outras ferramentas, o script <em>evaluate_model.py</em> pode ser utilizado para verificar o DOPE ao longo de toda cadeia, comparando-o com o molde. No exemplo abaixo, utilizamos o Modelo 1.
Script <em>evaluate_model.py</em></p>
<pre><code class="language-py">from modeller import *
from modeller.scripts import complete_pdb

log.verbose()    # request verbose output
env = environ()
env.libs.topology.read(file='$(LIB)/top_heav.lib') # read topology
env.libs.parameters.read(file='$(LIB)/par.lib') # read parameters

# read model file
mdl = complete_pdb(env, 'TvLDH.B99990001.pdb')

# Assess with DOPE:
s = selection(mdl)   # all atom selection
s.assess_dope(output='ENERGY_PROFILE NO_REPORT', file='TvLDH.profile',
              normalize_profile=True, smoothing_window=15) 
</code></pre>
<p>Neste script utilizamos o script <strong>complete_pdb</strong> para ler o arquivo PDB e prepará-lo para os cálculos de energia. O DOPE é então calculado com o comando <strong>assess_dope</strong>, e adicionalmente um perfil energético é calculado dentro de uma janela de 15 resíduos e normalizados pelo número de restrições agindo em cada resíduo. O perfil (no arquivo TvLDH.profile) é utilizado como input para um programa de gráfico. Não esqueça de editar o script para dar como entrada o modelo de melhor pontuação (Verificado no arquivo <em>model_single.log</em>).</p>
<p>Rode agora o script <em>evaluate_model.py</em>:</p>
<pre><code class="language-shell">$ mod9.20 evaluate_model.py
</code></pre>
<p>Agora rode o script <em>evaluate_template.py</em>, para ter o <em>profile</em> da estrutura 1bdm, para comparar os DOPEs escores entre o modelo e o molde.</p>
<pre><code class="language-shell">$ mod9.20 evaluate_template.py
</code></pre>
<p>Agora podemos utilizar o script <em>plot_profiles.py</em> (com o matplolib do Python) ou o programa GNUPLOT para obter o gráfico:</p>
<pre><code class="language-shell">$ python plot_profiles.py
</code></pre>
<p>ou</p>
<pre><code class="language-shell">$ gnuplot
&gt; plot &quot;TvLDH.profile&quot; using 1:42 with lines
</code></pre>
<ul>
<li>Quais região(-ões) você escolheria para melhorar a modelagem?</li>
</ul>
<h2 id="visualizacao-e-comparacao">Visualização e comparação</h2>
<p>Visualize os modelos e o molde no Chimera, utilizando a ferramenta (são menus):</p>
<ul>
<li><strong><em>Tools &gt; Structure comparison &gt; MatchMaker</em></strong>.</li>
</ul>
<p>Baixe o arquivo da estrutura resolvida da TvLDH, PDB <a href="https://www.rcsb.org/structure/4UUM">4UUM</a> e compare as 3 estruturas utilizando o comando acima.</p>
<p>Na ferramenta:</p>
<ul>
<li><strong><em>Tools &gt; Sequence &gt; Sequence</em></strong> veja a sequência primária do molde. </li>
<li>No item de menu <strong><em>Info</em></strong> obtenha as anotações do molde do banco UNIPROT.</li>
</ul>
<blockquote>
<p><em>Os sítios importantes para catálise estão conservados no seu modelo?</em></p>
</blockquote>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
